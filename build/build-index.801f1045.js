"use strict";function GameBoyAdvanceCompositor(e){this.gfx=e,this.doEffects=0}function GameBoyAdvanceWindowCompositor(e){this.gfx=e,this.doEffects=0}function GameBoyAdvanceOBJWindowCompositor(e){this.gfx=e,this.doEffects=0}function generateIodineGBAGFXCompositors(){!function(){function e(e,t,r){return function(e,o){function a(e,t,r){function o(e){var t="";return e||(t+="var "),t}var a="";if(e)switch(a+="var backdrop = SIMD.Int32x4.splat(this.gfx.backdrop | 0);",t){case 0:break;default:a+=o(r)+"workingPixel = this.mask0;var test1 = this.mask4;var test2 = this.mask4;";case 1:case 2:case 4:case 8:case 16:a+=o(r)+"currentPixel = this.mask0;"+o(r)+"lowerPixel = this.mask0;"}else switch(t){case 0:break;default:a+=o(r)+"workingPixel = 0;";case 1:case 2:case 4:case 8:case 16:a+=o(r)+"currentPixel = 0;"+o(r)+"lowerPixel = 0;"}return a}function n(e,t,r){function o(e){var t="";return t+=e?"lowerPixel = backdrop;":"lowerPixel = this.gfx.backdrop | 0;"}function a(e){var t="";return t+=e?"lowerPixel = backdrop;currentPixel = lowerPixel;":"lowerPixel = this.gfx.backdrop | 0;currentPixel = lowerPixel | 0;"}function n(e,t){var r="";return r+=e?"currentPixel = SIMD.Int32x4.load(this.buffer, xStart | "+t+");currentPixel = SIMD.Int32x4.select(SIMD.Int32x4.notEqual(this.mask0,SIMD.Int32x4.and(currentPixel, this.mask1)),lowerPixel,currentPixel);":"currentPixel = this.buffer[xStart | "+t+"] | 0;if ((currentPixel & 0x2000000) != 0) {currentPixel = lowerPixel | 0;}"}function i(e,t){var r="";return r+=e?"workingPixel = SIMD.Int32x4.load(this.buffer, xStart | "+t+");test1 = SIMD.Int32x4.lessThanOrEqual(SIMD.Int32x4.and(workingPixel, this.mask2),SIMD.Int32x4.and(currentPixel, this.mask3));lowerPixel = SIMD.Int32x4.select(test1, currentPixel, lowerPixel);currentPixel = SIMD.Int32x4.select(test1, workingPixel, currentPixel);test2 = SIMD.Int32x4.lessThanOrEqual(SIMD.Int32x4.and(workingPixel, this.mask2),SIMD.Int32x4.and(lowerPixel, this.mask3));lowerPixel = SIMD.Int32x4.select(test1,lowerPixel,SIMD.Int32x4.select(test2, workingPixel, lowerPixel));":"workingPixel = this.buffer[xStart | "+t+"] | 0;if ((workingPixel & 0x3800000) <= (currentPixel & 0x1800000)) {lowerPixel = currentPixel | 0;currentPixel = workingPixel | 0;}else if ((workingPixel & 0x3800000) <= (lowerPixel & 0x1800000)) {lowerPixel = workingPixel | 0;}"}function s(e,t){var r="";return r+=e?t?"SIMD.Int32x4.store(this.buffer, xStart | 0x700, lowerPixel);SIMD.Int32x4.store(this.buffer, xStart | 0x800, currentPixel);":"SIMD.Int32x4.store(this.buffer, xStart | 0, currentPixel);":t?"this.buffer[xStart | 0] = this.colorEffectsRenderer.processPixelNormal(lowerPixel | 0, currentPixel | 0) | 0;":"this.buffer[xStart | 0] = currentPixel | 0;"}function c(e,t){var r="";return e?r+="SIMD.Int32x4.store(this.buffer, xStart | 0x700, lowerPixel);SIMD.Int32x4.store(this.buffer, xStart | 0x800, currentPixel);":(r+="if ((currentPixel & 0x400000) == 0) {",r+=t?"this.buffer[xStart | 0] = this.colorEffectsRenderer.processPixelNormal(lowerPixel | 0, currentPixel | 0) | 0;":"this.buffer[xStart | 0] = currentPixel | 0;",r+="}else {this.buffer[xStart | 0] = this.colorEffectsRenderer.processPixelSprite(lowerPixel | 0, currentPixel | 0) | 0;}"),r}return function(e,t,r){var x="";switch(r){case 0:x+=function(e,t){var r="";return r+(e?t?"SIMD.Int32x4.store(this.buffer, xStart | 0x700, this.mask0);SIMD.Int32x4.store(this.buffer, xStart | 0x800, backdrop);":"SIMD.Int32x4.store(this.buffer, xStart | 0, backdrop);":t?"this.buffer[xStart | 0] = this.colorEffectsRenderer.processPixelNormal(0, this.gfx.backdrop | 0) | 0;":"this.buffer[xStart | 0] = this.gfx.backdrop | 0;")}(e,t);break;case 1:x+=o(e),x+=n(e,256),x+=s(e,t);break;case 2:x+=o(e),x+=n(e,512),x+=s(e,t);break;case 3:x+=a(e),x+=i(e,512),x+=i(e,256),x+=s(e,t);break;case 4:x+=o(e),x+=n(e,768),x+=s(e,t);break;case 5:x+=a(e),x+=i(e,768),x+=i(e,256),x+=s(e,t);break;case 6:x+=a(e),x+=i(e,768),x+=i(e,512),x+=s(e,t);break;case 7:x+=a(e),x+=i(e,768),x+=i(e,512),x+=i(e,256),x+=s(e,t);break;case 8:x+=o(e),x+=n(e,1024),x+=s(e,t);break;case 9:x+=a(e),x+=i(e,1024),x+=i(e,256),x+=s(e,t);break;case 10:x+=a(e),x+=i(e,1024),x+=i(e,512),x+=s(e,t);break;case 11:x+=a(e),x+=i(e,1024),x+=i(e,512),x+=i(e,256),x+=s(e,t);break;case 12:x+=a(e),x+=i(e,1024),x+=i(e,768),x+=s(e,t);break;case 13:x+=a(e),x+=i(e,1024),x+=i(e,768),x+=i(e,256),x+=s(e,t);break;case 14:x+=a(e),x+=i(e,1024),x+=i(e,768),x+=i(e,512),x+=s(e,t);break;case 15:x+=a(e),x+=i(e,1024),x+=i(e,768),x+=i(e,512),x+=i(e,256),x+=s(e,t);break;case 16:x+=o(e),x+=n(e,1280),x+=c(e,t);break;case 17:x+=a(e),x+=i(e,256),x+=i(e,1280),x+=c(e,t);break;case 18:x+=a(e),x+=i(e,512),x+=i(e,1280),x+=c(e,t);break;case 19:x+=a(e),x+=i(e,512),x+=i(e,256),x+=i(e,1280),x+=c(e,t);break;case 20:x+=a(e),x+=i(e,768),x+=i(e,1280),x+=c(e,t);break;case 21:x+=a(e),x+=i(e,768),x+=i(e,256),x+=i(e,1280),x+=c(e,t);break;case 22:x+=a(e),x+=i(e,768),x+=i(e,512),x+=i(e,1280),x+=c(e,t);break;case 23:x+=a(e),x+=i(e,768),x+=i(e,512),x+=i(e,256),x+=i(e,1280),x+=c(e,t);break;case 24:x+=a(e),x+=i(e,1024),x+=i(e,1280),x+=c(e,t);break;case 25:x+=a(e),x+=i(e,1024),x+=i(e,256),x+=i(e,1280),x+=c(e,t);break;case 26:x+=a(e),x+=i(e,1024),x+=i(e,512),x+=i(e,1280),x+=c(e,t);break;case 27:x+=a(e),x+=i(e,1024),x+=i(e,512),x+=i(e,256),x+=i(e,1280),x+=c(e,t);break;case 28:x+=a(e),x+=i(e,1024),x+=i(e,768),x+=i(e,1280),x+=c(e,t);break;case 29:x+=a(e),x+=i(e,1024),x+=i(e,768),x+=i(e,256),x+=i(e,1280),x+=c(e,t);break;case 30:x+=a(e),x+=i(e,1024),x+=i(e,768),x+=i(e,512),x+=i(e,1280),x+=c(e,t);break;default:x+=a(e),x+=i(e,1024),x+=i(e,768),x+=i(e,512),x+=i(e,256),x+=i(e,1280),x+=c(e,t)}return x}(e,t,r)}var i="";switch(o){case 0:i+=e?a(!0,r,!1)+"for (var xStart = 0; (xStart | 0) < 240; xStart = ((xStart | 0) + 4) | 0) {"+n(!0,t,r)+"}":a(!1,r,!1)+"for (var xStart = 0; (xStart | 0) < 240; xStart = ((xStart | 0) + 1) | 0) {"+n(!1,t,r)+"}";break;case 1:i+="xStart = xStart | 0;xEnd = xEnd | 0;",i+=e?a(!1,r,!1)+"while ((xStart | 0) < (xEnd | 0) && (xStart | 0) <= (xStart | 0x3)) {"+n(!1,t,r)+"xStart = ((xStart | 0) + 1) | 0;}var xStartCopy = xStart | 0;"+a(!0,r,!0)+"while ((xStart | 0) < (xEnd & -4)) {"+n(!0,t,r)+"xStart = ((xStart | 0) + 4) | 0;}"+a(!1,r,!0)+"while ((xStart | 0) < (xEnd | 0)) {"+n(!1,t,r)+"xStart = ((xStart | 0) + 1) | 0;}":a(!1,r,!1)+"while ((xStart | 0) < (xEnd | 0)) {"+n(!1,t,r)+"xStart = ((xStart | 0) + 1) | 0;}";break;case 2:i+=a(!1,r,!1)+"for (var xStart = 0; (xStart | 0) < 240; xStart = ((xStart | 0) + 1) | 0) {if ((this.OBJWindowBuffer[xStart | 0] | 0) < 0x3800000) {"+n(!1,t,r)+"}}"}return i+=function(e,r,o){var a="";if(e)switch(o){case 0:r<16?t&&(a+=";this.colorEffectsRenderer.processFullNormalEffectsNoSprites()"):a+=t?";this.colorEffectsRenderer.processFullNormalEffectsWithSprites()":";this.colorEffectsRenderer.processFullNoEffectsWithSprites()";break;case 1:r<16?t&&(a+=";this.colorEffectsRenderer.processWindowNormalEffectsNoSprites(xStartCopy | 0, xEnd & -4)"):a+=t?";this.colorEffectsRenderer.processWindowNormalEffectsWithSprites(xStartCopy | 0, xEnd & -4)":";this.colorEffectsRenderer.processWindowNoEffectsWithSprites(xStartCopy | 0, xEnd & -4)"}return a}(e,r,o),i}("object"==typeof SIMD&&"function"==typeof SIMD.Int32x4,e)}function t(t,r){for(var o=r?"special":"normal",a=0;a<32;a++){var n=e(t,r,a);switch(t){case 0:GameBoyAdvanceCompositor.prototype[o+a]=Function(n);break;case 1:GameBoyAdvanceWindowCompositor.prototype[o+a]=Function("xStart","xEnd",n);break;default:GameBoyAdvanceOBJWindowCompositor.prototype[o+a]=Function(n)}}}for(var r=0;r<3;r++)t(r,!1),t(r,!0)}(),function(){function e(e,t){return function(e,t){return e?Function("xStart","xEnd","layers",t):Function("layers",t)}(e,function(e,t){return function(e,t){var r="";return r+=function(e){var t="";return e&&(t+="xStart = xStart | 0;xEnd = xEnd | 0;"),t+"layers = layers | 0;"}(e),r+=function(e,t){return r=function(e,t){return function(e,t){function r(e,t,r){return function(e,t){return""+(e<31?"case "+e+":{"+t+";break};":"default:{"+t+"}")}(e,function(e,t,r){var o="this.";return o+=r?"special":"normal",o+=e+"(",t&&(o+="xStart | 0, xEnd | 0"),o+")"}(e,t,r))}return function(e,t){for(var o="",a=0;a<32;a++)o+=r(a,e,t);return o}(e,t)}(e,t)}(e,t),"switch (layers | 0) {"+r+"}";var r}(e,t),r}(e,t)}(e,t))}GameBoyAdvanceOBJWindowCompositor.prototype.renderNormalScanLine=GameBoyAdvanceCompositor.prototype.renderNormalScanLine=e(!1,!1),GameBoyAdvanceWindowCompositor.prototype.renderNormalScanLine=e(!0,!1),GameBoyAdvanceOBJWindowCompositor.prototype.renderScanLineWithEffects=GameBoyAdvanceCompositor.prototype.renderScanLineWithEffects=e(!1,!0),GameBoyAdvanceWindowCompositor.prototype.renderScanLineWithEffects=e(!0,!0)}()}GameBoyAdvanceCompositor.prototype.initialize=GameBoyAdvanceWindowCompositor.prototype.initialize=function(){this.buffer=this.gfx.buffer,this.colorEffectsRenderer=this.gfx.colorEffectsRenderer},GameBoyAdvanceOBJWindowCompositor.prototype.initialize=function(){this.buffer=this.gfx.buffer,this.colorEffectsRenderer=this.gfx.colorEffectsRenderer,this.OBJWindowBuffer=this.gfx.objRenderer.scratchWindowBuffer},GameBoyAdvanceCompositor.prototype.preprocess=GameBoyAdvanceWindowCompositor.prototype.preprocess=GameBoyAdvanceOBJWindowCompositor.prototype.preprocess=function(e){e|=0,this.doEffects=0|e},GameBoyAdvanceOBJWindowCompositor.prototype.renderScanLine=GameBoyAdvanceCompositor.prototype.renderScanLine=function(e){e|=0,0==(0|this.doEffects)?this.renderNormalScanLine(0|e):this.renderScanLineWithEffects(0|e)},GameBoyAdvanceWindowCompositor.prototype.renderScanLine=function(e,t,r){e|=0,t|=0,r|=0,0==(0|this.doEffects)?this.renderNormalScanLine(0|e,0|t,0|r):this.renderScanLineWithEffects(0|e,0|t,0|r)},"object"==typeof SIMD&&"function"==typeof SIMD.Int32x4&&(GameBoyAdvanceCompositor.prototype.mask0=SIMD.Int32x4.splat(0),GameBoyAdvanceCompositor.prototype.mask1=SIMD.Int32x4.splat(33554432),GameBoyAdvanceCompositor.prototype.mask2=SIMD.Int32x4.splat(58720256),GameBoyAdvanceCompositor.prototype.mask3=SIMD.Int32x4.splat(25165824),GameBoyAdvanceCompositor.prototype.mask4=SIMD.Bool32x4.splat(!0)),generateIodineGBAGFXCompositors();
//# sourceMappingURL=build-index.801f1045.js.map
