var isWarping=!1,switchingGameState=0,randomWarpsEnabled=!0;const FIRE_RED_LAST_BANK=33758644,FIRE_RED_CURRENT_BANK=33758652,FIRE_RED_CURRENT_MAP=33758653,FIRE_RED_CURRENT_WARP=33758654,EMERALD_LAST_BANK=33759964,EMERALD_CURRENT_BANK=33759972,EMERALD_CURRENT_MAP=33759973,EMERALD_CURRENT_WARP=33759974,EMERALD_MAP_TYPE=33780527,FIRE_RED_MAP_TYPE=33779219;var flagManager,isInSafari=!1;GameBoyAdvanceCPU.prototype.write32WithoutIntercept=GameBoyAdvanceCPU.prototype.write32,GameBoyAdvanceCPU.prototype.write32=function(e,t){if(0!=switchingGameState){if(1==switchingGameState&&(33758644==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode||33759964==e&&("E"===IodineGUI.Iodine.IOCore.cartridge.romCode||"C"===IodineGUI.Iodine.IOCore.cartridge.romCode))){IodineGUI.Iodine.pause();let e=IodineGUI.Iodine.IOCore.cartridge.romCode,t=readWRAMSlice("E"==e||"C"==e?EMERALD_PARTY_OFFSET:FIRE_RED_PARTY_OFFSET,PLAYER_PARTY_LENGTH),i=dynamicMemorySlice("E"==e||"C"==e?EMERALD_SAVE_2_PTR:FIRE_RED_SAVE_2_PTR,NAME_STATE_OFFSET,NAME_STATE_LENGTH),a=dynamicMemorySlice("E"==e||"C"==e?EMERALD_SAVE_2_PTR:FIRE_RED_SAVE_2_PTR,ID_TIME_OFFSET,ID_TIME_LENGTH),E=new BagStoreage;E.readData(e),(flagManager=new FlagManager(E.hasBike())).readFlags(e),IodineGUI.Iodine.saveStateManager.loadState(gameSwitchingWarp.toRomCode),"E"==gameSwitchingWarp.toRomCode||"C"==gameSwitchingWarp.toRomCode?(this.write8(33759972,gameSwitchingWarp.toBank),this.write8(33759973,gameSwitchingWarp.toMap),this.write8(33759974,gameSwitchingWarp.toWarpNo)):(this.write8(33758652,gameSwitchingWarp.toBank),this.write8(33758653,gameSwitchingWarp.toMap),this.write8(33758654,gameSwitchingWarp.toWarpNo));let r=IodineGUI.Iodine.IOCore.cartridge.romCode;return spliceWRAM("E"==r||"C"==r?EMERALD_PARTY_OFFSET:FIRE_RED_PARTY_OFFSET,PLAYER_PARTY_LENGTH,t),dynamicMemorySplice("E"==r||"C"==r?EMERALD_SAVE_2_PTR:FIRE_RED_SAVE_2_PTR,NAME_STATE_OFFSET,NAME_STATE_LENGTH,i),dynamicMemorySplice("E"==r||"C"==r?EMERALD_SAVE_2_PTR:FIRE_RED_SAVE_2_PTR,ID_TIME_OFFSET,ID_TIME_LENGTH,a),E.writeData(r,e,!0),flagManager.writeFlags(r,e,!0),IodineGUI.mixerInput.volume=0,switchingGameState=2,document.getElementById("emulator_target").classList.add("faded"),void IodineGUI.Iodine.play()}if(2==switchingGameState&&(33758644==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode||33759964==e&&("E"===IodineGUI.Iodine.IOCore.cartridge.romCode||"C"===IodineGUI.Iodine.IOCore.cartridge.romCode))){IodineGUI.mixerInput.volume=.1,document.getElementById("emulator_target").classList.remove("faded"),switchingGameState=0,isWarping=!1,gameSwitchingWarp=null}}33758644==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode?isInSafari=(new FlagManager).getFlag(IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_1_PTR),FIRE_RED_SYS_FLAGS_OFFSET,0):33759964==e&&"E"===IodineGUI.Iodine.IOCore.cartridge.romCode&&(isInSafari=(new FlagManager).getFlag(IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_1_PTR),EMERALD_SYS_FLAGS_OFFSET,44)),this.write32WithoutIntercept(e,t)},GameBoyAdvanceCPU.prototype.write8WithoutIntercept=GameBoyAdvanceCPU.prototype.write8,GameBoyAdvanceCPU.prototype.write8=function(e,t){33758654==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode?isWarping=randomWarpsEnabled||forceNextWarp:33759974!=e||"E"!==IodineGUI.Iodine.IOCore.cartridge.romCode&&"C"!==IodineGUI.Iodine.IOCore.cartridge.romCode||(isWarping=randomWarpsEnabled||forceNextWarp),this.write8WithoutIntercept(e,t)};const EMERALD_MOVEMENT_MODE_OFFSET=33781136,FIRE_RED_MOVEMENT_MODE_OFFSET=33779832,MOVEMENT_MODE_WALK=1,MOVEMENT_MODE_BIKE=2,MOVEMENT_MODE_SURF=8;var autoBike=!1,teleportAnywhere=!1;GameBoyAdvanceCPU.prototype.read8WithoutIntercept=GameBoyAdvanceCPU.prototype.read8,GameBoyAdvanceCPU.prototype.read8=function(e){if(autoBike){if(33779832==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode){let t=this.read8WithoutIntercept(e);return t<=1?2:t}if(33781136==e){let t=this.read8WithoutIntercept(e);return t<=1?2:t}}if(teleportAnywhere){if(33779219==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode)return 2;if(33780527==e)return 2}return isWarping?(33758652==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode?e=this.handleWarpRedirection(e,IodineGUI.Iodine.IOCore.cartridge.romCode):33759972!=e||"E"!==IodineGUI.Iodine.IOCore.cartridge.romCode&&"C"!==IodineGUI.Iodine.IOCore.cartridge.romCode||(e=this.handleWarpRedirection(e,IodineGUI.Iodine.IOCore.cartridge.romCode)),this.read8WithoutIntercept(e)):this.read8WithoutIntercept(e)};var gameSwitchingWarp=null,reverseNextWarp=!1,forceNextWarp=null;function specialWarpHandling(e){let t=e.toRomCode+","+e.toBank+","+e.toMap+","+e.toWarpNo;return("E,16,0,1"==t||"C,16,0,1"==t||"FR,1,75,1"==t)&&(e.toWarpNo=2),e}async function quickSpeedUp(e){let t=IodineGUI.Iodine.getSpeed();IodineGUI.Iodine.setSpeed(4),IodineGUI.mixerInput.volume=0,await delay(e),IodineGUI.Iodine.setSpeed(t),IodineGUI.mixerInput.volume=.1}function quickHideScreen(){let e=document.getElementById("emulator_target");e.classList.remove("quick-hide"),e.offsetWidth,e.classList.add("quick-hide")}function readWRAMSlice(e,t){let i=e-33554432,a=i+t;return IodineGUI.Iodine.IOCore.memory.externalRAM.slice(i,a)}function spliceWRAM(e,t,i){let a=e-33554432;for(let e=0;e<t;e++)IodineGUI.Iodine.IOCore.memory.externalRAM[a+e]=i[e]}GameBoyAdvanceCPU.prototype.handleWarpRedirection=function(e,t){let i=this.read8WithoutIntercept(e),a=this.read8WithoutIntercept(e+1),E=this.read8WithoutIntercept(e+2),r=this.handelHomeWarp(t,i,a,E);if(255==E&&!r)return e;if(2==switchingGameState||1==switchingGameState)return e;let o=null,_=t+","+i+","+a+","+E;if(forceNextWarp){let e=forceNextWarp.split(",");o=new PKWarp(_,e[0],e[1],e[2],e[3],forceNextWarp),reverseNextWarp=!1,forceNextWarp=null}else if(reverseNextWarp&&warpList.get(_)){let e=warpList.get(_).source,t=e.split(",");o=new PKWarp(_,t[0],t[1],t[2],t[3],e),reverseNextWarp=!1}else o=warpList.get(_),console.log("Warping triggered for "+_);return o?(o=specialWarpHandling(o),IodineGUI.Iodine.pause(),IodineGUI.Iodine.saveStateManager.saveState(t,!0),o.toRomCode[0]!=o.trigger[0]?(switchingGameState=1,gameSwitchingWarp=o,e="E"==o.toRomCode||"C"==o.toRomCode?33759972:33758652):"E"==o.toRomCode||"C"==o.toRomCode?(this.write8(33759972,o.toBank),this.write8(33759973,o.toMap),this.write8(33759974,o.toWarpNo),e=33759972):(this.write8(33758652,o.toBank),this.write8(33758653,o.toMap),this.write8(33758654,o.toWarpNo),e=33758652),IodineGUI.Iodine.play(),console.log("Warping sending to "+o.toRomCode+","+o.toBank+","+o.toMap+","+o.toWarpNo)):console.log("Warping sending to vanilla"),isWarping=!1,e},GameBoyAdvanceCPU.prototype.handelHomeWarp=function(e,t,i,a){if("FR"==e&&11==t&&0==i&&255==a){if(!isInSafari)return forceNextWarp=forceNextWarp||"FR,4,1,0",writeGameVar("FR",16494,0),!0}else if("E"==e&&23==t&&0==i&&255==a){if(!isInSafari)return forceNextWarp=forceNextWarp||"E,1,3,0",writeGameVar("E",16548,0),!0}else if("C"==e&&23==t&&0==i&&255==a)return forceNextWarp=forceNextWarp||"C,1,1,0",!0;return!1};var walkThroughWalls=!1,runIndoors=!1,frWallsOffset=364078,frRunIndoorsOffset=775316;GameBoyAdvanceMultiCartridge.prototype.initializeWithoutIntercept=GameBoyAdvanceMultiCartridge.prototype.initialize,GameBoyAdvanceMultiCartridge.prototype.initialize=function(e){this.initializeWithoutIntercept(e),this.cartriges.get("FR")&&this.cartriges.get("FR").ROM[188]&&(frWallsOffset=364098,frRunIndoorsOffset=775336)},GameBoyAdvanceMultiCartridge.prototype.readROM16WithoutIntercept=GameBoyAdvanceMultiCartridge.prototype.readROM16,GameBoyAdvanceMultiCartridge.prototype.readROM16=function(e){if(!walkThroughWalls&&!runIndoors)return this.readROM16WithoutIntercept(e);if(walkThroughWalls){if(e==frWallsOffset&&"FR"==this.romCode)return 8448;if(601094==e&&"C"==this.romCode)return 8192;if(601094==e&&"E"==this.romCode)return 8192}if(runIndoors){if(e==frRunIndoorsOffset&&"FR"==this.romCode)return 0;if(1155560==e&&"C"==this.romCode)return 0;if(1155560==e&&"E"==this.romCode)return 0}return this.readROM16WithoutIntercept(e)};var currentlySaving=!1;GameBoyAdvanceMultiCartridge.prototype.readROM8WithoutIntercept=GameBoyAdvanceMultiCartridge.prototype.readROM8,GameBoyAdvanceMultiCartridge.prototype.readROM8=function(e){return currentlySaving&&(this.cartriges.get("FR")&&this.cartriges.get("FR").ROM[188]&&(1857210==e||4305130==e||4306233==e)?syncSaveStateSaves():(!this.cartriges.get("FR")||1857098!=e&&4305018!=e&&4306121!=e)&&2681225!=e&&2918453!=e&&6214600!=e||syncSaveStateSaves()),this.readROM8WithoutIntercept(e)};const FIRE_RED_CURRENT_GROUND_OFFSET=33779267,EMERALD_CURRENT_GROUND_OFFSET=33780571,CURRENT_GROUND_LAND=51,CURRENT_GROUND_WATER=17,CURRENT_GROUND_LADDER=48,CURRENT_GROUND_ELEVATED=68,EMERALD_STATE_OFFSET=33781137,FIRE_RED_STATE_OFFSET=33779833;function forcePlayerState(e){IodineGUI.Iodine.IOCore&&("FR"===IodineGUI.Iodine.IOCore.cartridge.romCode?(IodineGUI.Iodine.IOCore.cpu.write8(33779833,e),8==e?IodineGUI.Iodine.IOCore.cpu.write8(33779267,17):IodineGUI.Iodine.IOCore.cpu.write8(33779267,51)):"C"===IodineGUI.Iodine.IOCore.cartridge.romCode?(IodineGUI.Iodine.IOCore.cpu.write8(33781136,e),IodineGUI.Iodine.IOCore.cpu.write8(33781137,e),8==e?IodineGUI.Iodine.IOCore.cpu.write8(33780571,17):IodineGUI.Iodine.IOCore.cpu.write8(33780571,51)):"E"===IodineGUI.Iodine.IOCore.cartridge.romCode&&(IodineGUI.Iodine.IOCore.cpu.write8(33781136,e),IodineGUI.Iodine.IOCore.cpu.write8(33781137,e),8==e?IodineGUI.Iodine.IOCore.cpu.write8(33780571,17):68==IodineGUI.Iodine.IOCore.cpu.read8(33780571)?IodineGUI.Iodine.IOCore.cpu.write8(33780571,68):IodineGUI.Iodine.IOCore.cpu.write8(33780571,48)))}function whiteoutTeam(){"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode?(IodineGUI.Iodine.IOCore.cpu.write8(FIRE_RED_PARTY_OFFSET+80,8),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86,1),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+100,0),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+200,0),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+300,0),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+400,0),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+500,0)):"C"!==IodineGUI.Iodine.IOCore.cartridge.romCode&&"E"!==IodineGUI.Iodine.IOCore.cartridge.romCode||(IodineGUI.Iodine.IOCore.cpu.write8(EMERALD_PARTY_OFFSET+80,8),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86,1),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+100,0),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+200,0),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+300,0),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+400,0),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+500,0))}function dynamicMemorySlice(e,t,i){let a=IodineGUI.Iodine.IOCore.cpu.read32(e)+t-33554432,E=a+i;return IodineGUI.Iodine.IOCore.memory.externalRAM.slice(a,E)}function dynamicMemorySplice(e,t,i,a){let E=IodineGUI.Iodine.IOCore.cpu.read32(e)+t-33554432;for(let e=0;e<i;e++)IodineGUI.Iodine.IOCore.memory.externalRAM[E+e]=a[e]}const EMERALD_PARTY_OFFSET=33703148,FIRE_RED_PARTY_OFFSET=33702532,PLAYER_PARTY_LENGTH=600,FIRE_RED_SAVE_1_PTR=50352136,EMERALD_SAVE_1_PTR=50355596,FIRE_RED_OBSF_MONEY_OFFSET=656,FIRE_RED_OBSF_MONEY_LENGTH=4,EMERALD_OBSF_MONEY_OFFSET=1168,EMERALD_OBSF_MONEY_LENGTH=4,FIRE_RED_SAVE_2_PTR=50352140,EMERALD_SAVE_2_PTR=50355600,NAME_STATE_OFFSET=0,NAME_STATE_LENGTH=9,ID_TIME_OFFSET=10,ID_TIME_LENGTH=12,FIRE_RED_XOR_KEY_OFFSET=3872,FIRE_RED_XOR_KEY_LENGTH=4,EMERALD_XOR_KEY_OFFSET=172,EMERALD_XOR_KEY_LENGTH=4,FIRE_RED_ITEM_OFFSET=784,FIRE_RED_ITEM_LENGTH=168,EMERALD_ITEM_OFFSET=1376,EMERALD_ITEM_LENGTH=120,FIRE_RED_KEY_ITEM_OFFSET=952,FIRE_RED_KEY_ITEM_LENGTH=120,EMERALD_KEY_ITEM_OFFSET=1496,EMERALD_KEY_ITEM_LENGTH=120,FIRE_RED_BALL_OFFSET=1072,FIRE_RED_BALL_LENGTH=52,EMERALD_BALL_OFFSET=1616,EMERALD_BALL_LENGTH=64,FIRE_RED_TM_OFFSET=1124,FIRE_RED_TM_LENGTH=232,EMERALD_TM_OFFSET=1680,EMERALD_TM_LENGTH=256,FIRE_RED_BERRIES_OFFSET=1356,FIRE_RED_BERRIES_LENGTH=172,EMERALD_BERRIES_OFFSET=1936,EMERALD_BERRIES_LENGTH=184;function BagStoreage(){this.money=null,this.itemPocket=new Map,this.keyItemsPocket=new Map,this.ballItemPocket=new Map,this.tmCase=new Map,this.berryPocket=new Map}BagStoreage.prototype.readData=function(e){"E"==e||"C"==e?this.readEmeraldData():this.readFireRedData()},BagStoreage.prototype.readFireRedData=function(){this.itemPocket.clear(),this.keyItemsPocket.clear(),this.ballItemPocket.clear(),this.tmCase.clear(),this.berryPocket.clear();let e=IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_2_PTR),t=IodineGUI.Iodine.IOCore.cpu.read32(e+3872),i=IodineGUI.Iodine.IOCore.cpu.read16(e+3872),a=IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_1_PTR);this.money=IodineGUI.Iodine.IOCore.cpu.read32(a+656)^t,this.readItemSection(a,784,168,this.itemPocket,i),this.readItemSection(a,952,120,this.keyItemsPocket,i),this.readItemSection(a,1072,52,this.ballItemPocket,i),this.readItemSection(a,1124,232,this.tmCase,i),this.readItemSection(a,1356,172,this.berryPocket,i)},BagStoreage.prototype.readEmeraldData=function(){this.itemPocket.clear(),this.keyItemsPocket.clear(),this.ballItemPocket.clear(),this.tmCase.clear(),this.berryPocket.clear();let e=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_2_PTR),t=IodineGUI.Iodine.IOCore.cpu.read32(e+172),i=IodineGUI.Iodine.IOCore.cpu.read16(e+172),a=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_1_PTR);this.money=IodineGUI.Iodine.IOCore.cpu.read32(a+1168)^t,this.readItemSection(a,1376,120,this.itemPocket,i),this.readItemSection(a,1496,120,this.keyItemsPocket,i),this.readItemSection(a,1616,64,this.ballItemPocket,i),this.readItemSection(a,1680,256,this.tmCase,i),this.readItemSection(a,1936,184,this.berryPocket,i)},BagStoreage.prototype.writeData=function(e,t,i){"E"==e||"C"==e?this.writeDataToEmerald(e,t,i):this.writeDataToFireRed(e,t,i)},BagStoreage.prototype.writeDataToFireRed=function(e,t,i){let a=IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_2_PTR),E=IodineGUI.Iodine.IOCore.cpu.read32(a+3872),r=IodineGUI.Iodine.IOCore.cpu.read16(a+3872),o=IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_1_PTR);if(IodineGUI.Iodine.IOCore.cpu.write32(o+656,this.money^E),this.berryPocket.size>=1&&this.keyItemsPocket.set(365,1),this.tmCase.size>=1&&this.keyItemsPocket.set(364,1),"C"==t){let e=this.tmCase.get(296),t=this.tmCase.get(344),i=this.keyItemsPocket.get(347);this.tmCase.delete(296),this.tmCase.delete(344),this.keyItemsPocket.delete(347),e&&this.tmCase.set(344,1),t&&this.keyItemsPocket.set(347,1),i&&this.tmCase.set(296,1)}this.writeItemSection(o,784,168,this.itemPocket,r,i),this.writeItemSection(o,952,120,this.keyItemsPocket,r,!1),this.writeItemSection(o,1072,52,this.ballItemPocket,r,i),this.writeItemSection(o,1124,232,this.tmCase,r,i),this.writeItemSection(o,1356,172,this.berryPocket,r,i)},BagStoreage.prototype.writeDataToEmerald=function(e,t,i){let a=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_2_PTR),E=IodineGUI.Iodine.IOCore.cpu.read32(a+172),r=IodineGUI.Iodine.IOCore.cpu.read16(a+172),o=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_1_PTR);if(IodineGUI.Iodine.IOCore.cpu.write32(o+1168,this.money^E),!this.keyItemsPocket.get(360)||this.keyItemsPocket.get(259)||this.keyItemsPocket.get(272)||(this.keyItemsPocket.set(259,1),this.keyItemsPocket.get(272,1)),"E"==e&&"C"==t){let e=this.tmCase.get(296),t=this.tmCase.get(344),i=this.keyItemsPocket.get(347);this.tmCase.delete(296),this.tmCase.delete(344),this.keyItemsPocket.delete(347),e&&this.tmCase.set(344,1),t&&this.keyItemsPocket.set(347,1),i&&this.tmCase.set(296,1)}else if("C"==e&&t&&"C"!=t){let e=this.tmCase.get(344),t=this.keyItemsPocket.get(347),i=this.tmCase.get(296);this.tmCase.delete(296),this.tmCase.delete(344),this.keyItemsPocket.delete(347),e&&this.tmCase.set(296,1),t&&this.tmCase.set(344,1),i&&this.keyItemsPocket.set(347,1)}this.writeItemSection(o,1376,120,this.itemPocket,r,i),this.writeItemSection(o,1496,120,this.keyItemsPocket,r,!1),this.writeItemSection(o,1616,64,this.ballItemPocket,r,i),this.writeItemSection(o,1680,256,this.tmCase,r,i),this.writeItemSection(o,1936,184,this.berryPocket,r,i)},BagStoreage.prototype.readItemSection=function(e,t,i,a,E){for(let r=0;r<t+i;r+=4){let i=IodineGUI.Iodine.IOCore.cpu.read16(e+t+r);if(0==i)break;let o=IodineGUI.Iodine.IOCore.cpu.read16(e+t+r+2)^E;a.set(i,o)}},BagStoreage.prototype.writeItemSection=function(e,t,i,a,E,r){var o=[...a];for(let a=0;a<t+i;a+=4){if(o.length>a/4){let i=o[a/4][0],r=o[a/4][1]^E;IodineGUI.Iodine.IOCore.cpu.write16(e+t+a,i),IodineGUI.Iodine.IOCore.cpu.write16(e+t+a+2,r)}else{if(!r)break;{let i=ITEM_DATA.Nothing.number,r=0^E;IodineGUI.Iodine.IOCore.cpu.write16(e+t+a,i),IodineGUI.Iodine.IOCore.cpu.write16(e+t+a+2,r)}}}},BagStoreage.prototype.hasBike=function(){return(this.keyItemsPocket.get(259)||0)+(this.keyItemsPocket.get(272)||0)+(this.keyItemsPocket.get(360)||0)>0};var badgeSync=!0;const FIRE_RED_BASE_FLAG_OFFSET=3808,FIRE_RED_SYS_FLAGS_OFFSET=4064,FIRE_RED_BADGE1_OFFSET=32,FIRE_RED_BADGE2_OFFSET=33,FIRE_RED_BADGE3_OFFSET=34,FIRE_RED_BADGE4_OFFSET=35,FIRE_RED_BADGE5_OFFSET=36,FIRE_RED_BADGE6_OFFSET=37,FIRE_RED_BADGE7_OFFSET=38,FIRE_RED_BADGE8_OFFSET=39,FIRE_RED_RUNNING_SHOE_OFFSET=47,FIRE_RED_POKEDEX_OFFSET=41,FIRE_RED_NATIONAL_DEX_OFFSET=64,FIRE_RED_BADGE_OFFSETS=[32,33,34,35,36,37,38,39],FIRE_RED_BIKE_OBTAINED_OFFSET=625,EMERALD_SYS_FLAGS_OFFSET=4988,EMERALD_BADGE1_OFFSET=7,EMERALD_BADGE2_OFFSET=8,EMERALD_BADGE3_OFFSET=9,EMERALD_BADGE4_OFFSET=10,EMERALD_BADGE5_OFFSET=11,EMERALD_BADGE6_OFFSET=12,EMERALD_BADGE7_OFFSET=13,EMERALD_BADGE8_OFFSET=14,EMERALD_RUNNING_SHOE_OFFSET=96,EMERALD_POKEDEX_OFFSET=1,EMERALD_NATIONAL_DEX_OFFSET=54,EMERALD_BADGE_OFFSETS=[7,8,9,10,11,12,13,14],EMERALD_BASE_VAR_OFFSET=5020,FIRE_RED_BASE_VAR_OFFSET=4096,EMERALD_REPEL_STEPS_OFFSET=16417,FIRE_RED_REPEL_STEPS_OFFSET=16416,EMERALD_STARTER_CHOICE_OFFSET=16419,FIRE_RED_STARTER_CHOICE_OFFSET=16433;function FlagManager(e){this.badge1=null,this.badge2=null,this.badge3=null,this.badge4=null,this.badge5=null,this.badge6=null,this.badge7=null,this.badge8=null,this.hasRunningShoes=null,this.HMState=null,this.hasBike=e,this.repelSteps=null,this.starterChoice=null}function modifyBadge(e,t,i){modifySystemFlag(e,("FR"==e?FIRE_RED_BADGE_OFFSETS:EMERALD_BADGE_OFFSETS)[t-1],i)}function modifyRunningShoes(e,t){modifySystemFlag(e,"FR"==e?47:96,t)}function modifySystemFlag(e,t,i){let a=new FlagManager;a.readFlags(e);let E="FR"==e?FIRE_RED_SAVE_1_PTR:EMERALD_SAVE_1_PTR,r=IodineGUI.Iodine.IOCore.cpu.read32(E),o="FR"==e?FIRE_RED_SYS_FLAGS_OFFSET:EMERALD_SYS_FLAGS_OFFSET;a.setFlag(r,o,t,i)}function readSystemFlag(e,t){let i=new FlagManager;i.readFlags(e);let a="FR"==e?FIRE_RED_SAVE_1_PTR:EMERALD_SAVE_1_PTR,E=IodineGUI.Iodine.IOCore.cpu.read32(a),r="FR"==e?FIRE_RED_SYS_FLAGS_OFFSET:EMERALD_SYS_FLAGS_OFFSET;return i.getFlag(E,r,t)}function writeGameVar(e,t,i){let a="FR"==e?FIRE_RED_SAVE_1_PTR:EMERALD_SAVE_1_PTR,E=IodineGUI.Iodine.IOCore.cpu.read32(a),r="FR"==e?4096:5020;IodineGUI.Iodine.IOCore.cpu.write16(E+r+2*(t-16384),i)}function readGameVar(e,t){let i="FR"==e?FIRE_RED_SAVE_1_PTR:EMERALD_SAVE_1_PTR,a=IodineGUI.Iodine.IOCore.cpu.read32(i),E="FR"==e?4096:5020;return IodineGUI.Iodine.IOCore.cpu.read16(a+E+2*(t-16384))}function HMState(){this.canFlash=!1,this.canCut=!1,this.canFly=!1,this.canStrength=!1,this.canSurf=!1,this.canSmash=!1,this.canWaterfall=!1,this.canDive=!1,this.canWhirlpool=!1}FlagManager.prototype.getFlag=function(e,t,i){let a=i%8;return!!+IodineGUI.Iodine.IOCore.cpu.read8(e+t+Math.ceil((i+1)/8)-1).toString(2).padStart(8,0).split("").reverse()[a]},FlagManager.prototype.setFlag=function(e,t,i,a){let E=i%8,r=IodineGUI.Iodine.IOCore.cpu.read8(e+t+Math.ceil((i+1)/8)-1).toString(2).padStart(8,0).split("").reverse();r[E]=a,IodineGUI.Iodine.IOCore.cpu.write8(e+t+Math.ceil((i+1)/8)-1,parseInt(r.reverse().join(""),2))},FlagManager.prototype.readFlags=function(e){"E"==e?this.readEmeraldFlags():"C"==e?this.readCrystalFlags():this.readFireRedFlags()},FlagManager.prototype.readEmeraldFlags=function(){let e=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_1_PTR);this.badge1=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,7),this.badge2=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,8),this.badge3=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,9),this.badge4=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,10),this.badge5=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,11),this.badge6=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,12),this.badge7=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,13),this.badge8=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,14),this.hasRunningShoes=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,96),this.HMState=new HMState,this.HMState.evaluate("E",this.badge1,this.badge2,this.badge3,this.badge4,this.badge5,this.badge6,this.badge7,this.badge8),this.repelSteps=readGameVar("E",16417),this.starterChoice=readGameVar("E",16419)},FlagManager.prototype.readCrystalFlags=function(){let e=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_1_PTR);this.badge1=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,7),this.badge2=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,8),this.badge3=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,9),this.badge4=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,10),this.badge5=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,11),this.badge6=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,12),this.badge7=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,13),this.badge8=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,14),this.hasRunningShoes=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,96),this.HMState=new HMState,this.HMState.evaluate("C",this.badge1,this.badge2,this.badge3,this.badge4,this.badge5,this.badge6,this.badge7,this.badge8),this.repelSteps=readGameVar("C",16417),this.starterChoice=readGameVar("C",16419)},FlagManager.prototype.readFireRedFlags=function(){let e=IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_1_PTR);this.badge1=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,32),this.badge2=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,33),this.badge3=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,34),this.badge4=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,35),this.badge5=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,36),this.badge6=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,37),this.badge7=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,38),this.badge8=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,39),this.hasRunningShoes=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,47),this.HMState=new HMState,this.HMState.evaluate("FR",this.badge1,this.badge2,this.badge3,this.badge4,this.badge5,this.badge6,this.badge7,this.badge8),this.repelSteps=readGameVar("FR",16416),this.starterChoice=readGameVar("FR",16433)},FlagManager.prototype.writeFlags=function(e,t){"E"==e?this.writeEmeraldFlags():"C"==e?this.writeCrystalFlags():this.writeFireRedFlags()},FlagManager.prototype.writeEmeraldFlags=function(){let e=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_1_PTR);if(this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,96,+this.hasRunningShoes),badgeSync){let t=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,7),i=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,8),a=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,9),E=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,10),r=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,11),o=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,12),_=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,13),F=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,14),n=this.HMState.updateBadges("E",t,i,a,E,r,o,_,F);this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,7,+(n[0]||t)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,8,+(n[1]||i)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,9,+(n[2]||a)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,10,+(n[3]||E)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,11,+(n[4]||r)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,12,+(n[5]||o)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,13,+(n[6]||_)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,14,+(n[7]||F))}writeGameVar("E",16417,this.repelSteps),writeGameVar("E",16419,this.starterChoice)},FlagManager.prototype.writeCrystalFlags=function(){let e=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_1_PTR);this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,96,+this.hasRunningShoes),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,54,1),writeGameVar("E",16462,770);let t=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_2_PTR);if(IodineGUI.Iodine.IOCore.cpu.write8(t+26,218),badgeSync){let t=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,7),i=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,8),a=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,9),E=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,10),r=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,11),o=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,12),_=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,13),F=this.getFlag(e,EMERALD_SYS_FLAGS_OFFSET,14),n=this.HMState.updateBadges("C",t,i,a,E,r,o,_,F);this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,7,+(n[0]||t)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,8,+(n[1]||i)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,9,+(n[2]||a)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,10,+(n[3]||E)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,11,+(n[4]||r)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,12,+(n[5]||o)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,13,+(n[6]||_)),this.setFlag(e,EMERALD_SYS_FLAGS_OFFSET,14,+(n[7]||F))}writeGameVar("C",16417,this.repelSteps),writeGameVar("C",16419,this.starterChoice)},FlagManager.prototype.writeFireRedFlags=function(){let e=IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_1_PTR);this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,47,+this.hasRunningShoes),this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,64,1),writeGameVar("FR",16462,25176);let t=IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_2_PTR);if(IodineGUI.Iodine.IOCore.cpu.write8(t+27,185),this.hasBike&&this.setFlag(e,3808,625,1),badgeSync){let t=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,32),i=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,33),a=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,34),E=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,35),r=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,36),o=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,37),_=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,38),F=this.getFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,39),n=this.HMState.updateBadges("FR",t,i,a,E,r,o,_,F);this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,32,+(n[0]||t)),this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,33,+(n[1]||i)),this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,34,+(n[2]||a)),this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,35,+(n[3]||E)),this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,36,+(n[4]||r)),this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,37,+(n[5]||o)),this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,38,+(n[6]||_)),this.setFlag(e,FIRE_RED_SYS_FLAGS_OFFSET,39,+(n[7]||F))}writeGameVar("FR",16416,this.repelSteps),writeGameVar("FR",16433,this.starterChoice)},HMState.prototype.evaluate=function(e,t,i,a,E,r,o,_,F){"E"==e?(this.canFlash=i,this.canCut=t,this.canFly=o,this.canStrength=E,this.canSurf=r,this.canSmash=a,this.canWaterfall=F,this.canDive=_,this.canWhirlpool=!1):"C"==e?(this.canFlash=t,this.canCut=i,this.canFly=r,this.canStrength=a,this.canSurf=E,this.canSmash=!1,this.canWaterfall=F,this.canDive=!1,this.canWhirlpool=_):(this.canFlash=t,this.canCut=i,this.canFly=a,this.canStrength=E,this.canSurf=r,this.canSmash=o,this.canWaterfall=_,this.canDive=!1,this.canWhirlpool=!1)},HMState.prototype.updateBadges=function(e,t,i,a,E,r,o,_,F){let n=[];return"E"==e?(n[0]=+(t||this.canCut),n[1]=+(i||this.canFlash),n[2]=+(a||this.canSmash),n[3]=+(E||this.canStrength),n[4]=+(r||this.canSurf),n[5]=+(o||this.canFly),n[6]=+(_||this.canDive),n[7]=+(F||this.canWaterfall)):"C"==e?(n[0]=+(t||this.canFlash),n[1]=+(i||this.canCut),n[2]=+(a||this.canStrength),n[3]=+(E||this.canSurf),n[4]=+(r||this.canFly),n[7]=+(F||this.canWaterfall)):(n[0]=+(t||this.canFlash),n[1]=+(i||this.canCut),n[2]=+(a||this.canFly),n[3]=+(E||this.canStrength),n[4]=+(r||this.canSurf),n[5]=+(o||this.canSmash),n[6]=+(_||this.canWaterfall)),n};
//# sourceMappingURL=index.96a8f0c6.js.map
