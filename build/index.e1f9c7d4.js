var isWarping=!1,switchingGameState=0,randomWarpsEnabled=!0;const FIRE_RED_LAST_BANK=33758644,FIRE_RED_CURRENT_BANK=33758652,FIRE_RED_CURRENT_MAP=33758653,FIRE_RED_CURRENT_WARP=33758654,EMERALD_LAST_BANK=33759964,EMERALD_CURRENT_BANK=33759972,EMERALD_CURRENT_MAP=33759973,EMERALD_CURRENT_WARP=33759974,EMERALD_MAP_TYPE=33780527,FIRE_RED_MAP_TYPE=33779219;GameBoyAdvanceCPU.prototype.write32WithoutIntercept=GameBoyAdvanceCPU.prototype.write32,GameBoyAdvanceCPU.prototype.write32=function(e,t){if(0!=switchingGameState){if(1==switchingGameState&&(33758644==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode||33759964==e&&("E"===IodineGUI.Iodine.IOCore.cartridge.romCode||"C"===IodineGUI.Iodine.IOCore.cartridge.romCode))){IodineGUI.Iodine.pause();let e=IodineGUI.Iodine.IOCore.cartridge.romCode,t=readWRAMSlice("E"==e||"C"==e?EMERALD_PARTY_OFFSET:FIRE_RED_PARTY_OFFSET,PLAYER_PARTY_LENGTH),i=dynamicMemorySlice("E"==e||"C"==e?EMERALD_SAVE_2_PTR:FIRE_RED_SAVE_2_PTR,NAME_STATE_OFFSET,NAME_STATE_LENGTH),o=dynamicMemorySlice("E"==e||"C"==e?EMERALD_SAVE_2_PTR:FIRE_RED_SAVE_2_PTR,ID_TIME_OFFSET,ID_TIME_LENGTH),r=new BagStoreage;r.readData(e),IodineGUI.Iodine.saveStateManager.loadState(gameSwitchingWarp.toRomCode),"E"==gameSwitchingWarp.toRomCode||"C"==gameSwitchingWarp.toRomCode?(this.write8(33759972,gameSwitchingWarp.toBank),this.write8(33759973,gameSwitchingWarp.toMap),this.write8(33759974,gameSwitchingWarp.toWarpNo)):(this.write8(33758652,gameSwitchingWarp.toBank),this.write8(33758653,gameSwitchingWarp.toMap),this.write8(33758654,gameSwitchingWarp.toWarpNo));let I=IodineGUI.Iodine.IOCore.cartridge.romCode;return spliceWRAM("E"==I||"C"==I?EMERALD_PARTY_OFFSET:FIRE_RED_PARTY_OFFSET,PLAYER_PARTY_LENGTH,t),dynamicMemorySplice("E"==I||"C"==I?EMERALD_SAVE_2_PTR:FIRE_RED_SAVE_2_PTR,NAME_STATE_OFFSET,NAME_STATE_LENGTH,i),dynamicMemorySplice("E"==I||"C"==I?EMERALD_SAVE_2_PTR:FIRE_RED_SAVE_2_PTR,ID_TIME_OFFSET,ID_TIME_LENGTH,o),r.writeData(I,e),IodineGUI.mixerInput.volume=0,switchingGameState=2,document.getElementById("emulator_target").classList.add("faded"),void IodineGUI.Iodine.play()}if(2==switchingGameState&&(33758644==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode||33759964==e&&("E"===IodineGUI.Iodine.IOCore.cartridge.romCode||"C"===IodineGUI.Iodine.IOCore.cartridge.romCode))){IodineGUI.mixerInput.volume=.1,document.getElementById("emulator_target").classList.remove("faded"),switchingGameState=0,isWarping=!1,gameSwitchingWarp=null}}this.write32WithoutIntercept(e,t)},GameBoyAdvanceCPU.prototype.write8WithoutIntercept=GameBoyAdvanceCPU.prototype.write8,GameBoyAdvanceCPU.prototype.write8=function(e,t){33758654==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode?isWarping=randomWarpsEnabled:33759974!=e||"E"!==IodineGUI.Iodine.IOCore.cartridge.romCode&&"C"!==IodineGUI.Iodine.IOCore.cartridge.romCode||(isWarping=randomWarpsEnabled),this.write8WithoutIntercept(e,t)};const EMERALD_MOVEMENT_MODE_OFFSET=33781136,FIRE_RED_MOVEMENT_MODE_OFFSET=33779832,MOVEMENT_MODE_WALK=1,MOVEMENT_MODE_BIKE=2,MOVEMENT_MODE_SURF=8;var autoBike=!1,teleportAnywhere=!1;GameBoyAdvanceCPU.prototype.read8WithoutIntercept=GameBoyAdvanceCPU.prototype.read8,GameBoyAdvanceCPU.prototype.read8=function(e){if(autoBike){if(33779832==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode){let t=this.read8WithoutIntercept(e);return t<=1?2:t}if(33781136==e){let t=this.read8WithoutIntercept(e);return t<=1?2:t}}if(teleportAnywhere){if(33779219==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode)return 2;if(33780527==e)return 2}return isWarping?(33758652==e&&"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode?e=this.handleWarpRedirection(e,IodineGUI.Iodine.IOCore.cartridge.romCode):33759972!=e||"E"!==IodineGUI.Iodine.IOCore.cartridge.romCode&&"C"!==IodineGUI.Iodine.IOCore.cartridge.romCode||(e=this.handleWarpRedirection(e,IodineGUI.Iodine.IOCore.cartridge.romCode)),this.read8WithoutIntercept(e)):this.read8WithoutIntercept(e)};var gameSwitchingWarp=null,reverseNextWarp=!1,forceNextWarp=null;async function quickSpeedUp(e){let t=IodineGUI.Iodine.getSpeed();IodineGUI.Iodine.setSpeed(4),IodineGUI.mixerInput.volume=0,await delay(e),IodineGUI.Iodine.setSpeed(t),IodineGUI.mixerInput.volume=.1}function quickHideScreen(){let e=document.getElementById("emulator_target");e.classList.remove("quick-hide"),e.offsetWidth,e.classList.add("quick-hide")}function readWRAMSlice(e,t){let i=e-33554432,o=i+t;return IodineGUI.Iodine.IOCore.memory.externalRAM.slice(i,o)}function spliceWRAM(e,t,i){let o=e-33554432;for(let e=0;e<t;e++)IodineGUI.Iodine.IOCore.memory.externalRAM[o+e]=i[e]}GameBoyAdvanceCPU.prototype.handleWarpRedirection=function(e,t){let i=this.read8WithoutIntercept(e),o=this.read8WithoutIntercept(e+1),r=this.read8WithoutIntercept(e+2);if(255==r)return e;if(2==switchingGameState||1==switchingGameState)return e;let I=null,n=t+","+i+","+o+","+r;if(forceNextWarp){let e=forceNextWarp.split(",");I=new PKWarp(n,e[0],e[1],e[2],e[3],forceNextWarp),reverseNextWarp=!1,forceNextWarp=null}else if(reverseNextWarp&&warpList.get(n)){let e=warpList.get(n).source,t=e.split(",");I=new PKWarp(n,t[0],t[1],t[2],t[3],e),reverseNextWarp=!1}else I=warpList.get(n),console.log("Warping triggered for "+n);return I?(IodineGUI.Iodine.pause(),IodineGUI.Iodine.saveStateManager.saveState(t,!0),I.toRomCode[0]!=I.trigger[0]?(switchingGameState=1,gameSwitchingWarp=I,e="E"==I.toRomCode||"C"==I.toRomCode?33759972:33758652):"E"==I.toRomCode||"C"==I.toRomCode?(this.write8(33759972,I.toBank),this.write8(33759973,I.toMap),this.write8(33759974,I.toWarpNo),e=33759972):(this.write8(33758652,I.toBank),this.write8(33758653,I.toMap),this.write8(33758654,I.toWarpNo),e=33758652),IodineGUI.Iodine.play(),console.log("Warping sending to "+I.toRomCode+","+I.toBank+","+I.toMap+","+I.toWarpNo)):console.log("Warping sending to vanilla"),isWarping=!1,e};var walkThroughWalls=!1,frOffset=364078;GameBoyAdvanceMultiCartridge.prototype.initializeWithoutIntercept=GameBoyAdvanceMultiCartridge.prototype.initialize,GameBoyAdvanceMultiCartridge.prototype.initialize=function(e){this.initializeWithoutIntercept(e),this.cartriges.get("FR")&&this.cartriges.get("FR").ROM[188]&&(frOffset=364098)},GameBoyAdvanceMultiCartridge.prototype.readROM16WithoutIntercept=GameBoyAdvanceMultiCartridge.prototype.readROM16,GameBoyAdvanceMultiCartridge.prototype.readROM16=function(e){return walkThroughWalls?e==frOffset&&"FR"==this.romCode?8448:601094==e&&"C"==this.romCode||601094==e&&"E"==this.romCode?8192:this.readROM16WithoutIntercept(e):this.readROM16WithoutIntercept(e)};const FIRE_RED_CURRENT_GROUND_OFFSET=33779267,EMERALD_CURRENT_GROUND_OFFSET=33780571,CURRENT_GROUND_LAND=51,CURRENT_GROUND_WATER=17,EMERALD_STATE_OFFSET=33781137,FIRE_RED_STATE_OFFSET=33779833;function forcePlayerState(e){IodineGUI.Iodine.IOCore&&("FR"===IodineGUI.Iodine.IOCore.cartridge.romCode?(IodineGUI.Iodine.IOCore.cpu.write8(33779833,e),8==e?IodineGUI.Iodine.IOCore.cpu.write8(33779267,17):IodineGUI.Iodine.IOCore.cpu.write8(33779267,51)):("C"===IodineGUI.Iodine.IOCore.cartridge.romCode||"E"===IodineGUI.Iodine.IOCore.cartridge.romCode)&&(IodineGUI.Iodine.IOCore.cpu.write8(33781136,e),IodineGUI.Iodine.IOCore.cpu.write8(33781137,e),8==e?IodineGUI.Iodine.IOCore.cpu.write8(33780571,17):IodineGUI.Iodine.IOCore.cpu.write8(33780571,51)))}function whiteoutTeam(){"FR"===IodineGUI.Iodine.IOCore.cartridge.romCode?(IodineGUI.Iodine.IOCore.cpu.write8(FIRE_RED_PARTY_OFFSET+80,8),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86,1),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+100,0),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+200,0),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+300,0),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+400,0),IodineGUI.Iodine.IOCore.cpu.write16(FIRE_RED_PARTY_OFFSET+86+500,0)):"C"!==IodineGUI.Iodine.IOCore.cartridge.romCode&&"E"!==IodineGUI.Iodine.IOCore.cartridge.romCode||(IodineGUI.Iodine.IOCore.cpu.write8(EMERALD_PARTY_OFFSET+80,8),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86,1),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+100,0),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+200,0),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+300,0),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+400,0),IodineGUI.Iodine.IOCore.cpu.write16(EMERALD_PARTY_OFFSET+86+500,0))}const EMERALD_PARTY_OFFSET=33703148,FIRE_RED_PARTY_OFFSET=33702532,PLAYER_PARTY_LENGTH=600,FIRE_RED_SAVE_1_PTR=50352136,EMERALD_SAVE_1_PTR=50355596,FIRE_RED_OBSF_MONEY_OFFSET=656,FIRE_RED_OBSF_MONEY_LENGTH=4,EMERALD_OBSF_MONEY_OFFSET=1168,EMERALD_OBSF_MONEY_LENGTH=4,FIRE_RED_SAVE_2_PTR=50352140,EMERALD_SAVE_2_PTR=50355600,NAME_STATE_OFFSET=0,NAME_STATE_LENGTH=9,ID_TIME_OFFSET=10,ID_TIME_LENGTH=12,FIRE_RED_XOR_KEY_OFFSET=3872,FIRE_RED_XOR_KEY_LENGTH=4,EMERALD_XOR_KEY_OFFSET=172,EMERALD_XOR_KEY_LENGTH=4,FIRE_RED_ITEM_OFFSET=784,FIRE_RED_ITEM_LENGTH=168,EMERALD_ITEM_OFFSET=1376,EMERALD_ITEM_LENGTH=120,FIRE_RED_KEY_ITEM_OFFSET=952,FIRE_RED_KEY_ITEM_LENGTH=120,EMERALD_KEY_ITEM_OFFSET=1496,EMERALD_KEY_ITEM_LENGTH=120,FIRE_RED_BALL_OFFSET=1072,FIRE_RED_BALL_LENGTH=52,EMERALD_BALL_OFFSET=1616,EMERALD_BALL_LENGTH=64,FIRE_RED_TM_OFFSET=1124,FIRE_RED_TM_LENGTH=232,EMERALD_TM_OFFSET=1680,EMERALD_TM_LENGTH=256,FIRE_RED_BERRIES_OFFSET=1356,FIRE_RED_BERRIES_LENGTH=172,EMERALD_BERRIES_OFFSET=1936,EMERALD_BERRIES_LENGTH=184;function dynamicMemorySlice(e,t,i){let o=IodineGUI.Iodine.IOCore.cpu.read32(e)+t-33554432,r=o+i;return IodineGUI.Iodine.IOCore.memory.externalRAM.slice(o,r)}function dynamicMemorySplice(e,t,i,o){let r=IodineGUI.Iodine.IOCore.cpu.read32(e)+t-33554432;for(let e=0;e<i;e++)IodineGUI.Iodine.IOCore.memory.externalRAM[r+e]=o[e]}function BagStoreage(){this.money=null,this.itemPocket=new Map,this.keyItemsPocket=new Map,this.ballItemPocket=new Map,this.tmCase=new Map,this.berryPocket=new Map}BagStoreage.prototype.readData=function(e){"E"==e||"C"==e?this.readEmeraldData():this.readFireRedData()},BagStoreage.prototype.readFireRedData=function(){this.itemPocket.clear(),this.keyItemsPocket.clear(),this.ballItemPocket.clear(),this.tmCase.clear(),this.berryPocket.clear();let e=IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_2_PTR),t=IodineGUI.Iodine.IOCore.cpu.read32(e+3872),i=IodineGUI.Iodine.IOCore.cpu.read16(e+3872),o=IodineGUI.Iodine.IOCore.cpu.read32(50352136);this.money=IodineGUI.Iodine.IOCore.cpu.read32(o+656)^t,this.readItemSection(o,784,168,this.itemPocket,i),this.readItemSection(o,952,120,this.keyItemsPocket,i),this.readItemSection(o,1072,52,this.ballItemPocket,i),this.readItemSection(o,1124,232,this.tmCase,i),this.readItemSection(o,1356,172,this.berryPocket,i)},BagStoreage.prototype.readEmeraldData=function(){this.itemPocket.clear(),this.keyItemsPocket.clear(),this.ballItemPocket.clear(),this.tmCase.clear(),this.berryPocket.clear();let e=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_2_PTR),t=IodineGUI.Iodine.IOCore.cpu.read32(e+172),i=IodineGUI.Iodine.IOCore.cpu.read16(e+172),o=IodineGUI.Iodine.IOCore.cpu.read32(50355596);this.money=IodineGUI.Iodine.IOCore.cpu.read32(o+1168)^t,this.readItemSection(o,1376,120,this.itemPocket,i),this.readItemSection(o,1496,120,this.keyItemsPocket,i),this.readItemSection(o,1616,64,this.ballItemPocket,i),this.readItemSection(o,1680,256,this.tmCase,i),this.readItemSection(o,1936,184,this.berryPocket,i)},BagStoreage.prototype.writeData=function(e,t){"E"==e||"C"==e?this.writeDataToEmerald(e,t):this.writeDataToFireRed(e,t)},BagStoreage.prototype.writeDataToFireRed=function(e,t){let i=IodineGUI.Iodine.IOCore.cpu.read32(FIRE_RED_SAVE_2_PTR),o=IodineGUI.Iodine.IOCore.cpu.read32(i+3872),r=IodineGUI.Iodine.IOCore.cpu.read16(i+3872),I=IodineGUI.Iodine.IOCore.cpu.read32(50352136);if(IodineGUI.Iodine.IOCore.cpu.write32(I+656,this.money^o),this.berryPocket.size>=1&&this.keyItemsPocket.set(365,1),this.tmCase.size>=1&&this.keyItemsPocket.set(364,1),"C"==t){let e=this.tmCase.get(296),t=this.tmCase.get(344),i=this.keyItemsPocket.get(347);this.tmCase.delete(296),this.tmCase.delete(344),this.keyItemsPocket.delete(347),e&&this.tmCase.set(344,1),t&&this.keyItemsPocket.set(347,1),i&&this.tmCase.set(296,1)}this.writeItemSection(I,784,168,this.itemPocket,r,!0),this.writeItemSection(I,952,120,this.keyItemsPocket,r,!1),this.writeItemSection(I,1072,52,this.ballItemPocket,r,!0),this.writeItemSection(I,1124,232,this.tmCase,r,!0),this.writeItemSection(I,1356,172,this.berryPocket,r,!0)},BagStoreage.prototype.writeDataToEmerald=function(e,t){let i=IodineGUI.Iodine.IOCore.cpu.read32(EMERALD_SAVE_2_PTR),o=IodineGUI.Iodine.IOCore.cpu.read32(i+172),r=IodineGUI.Iodine.IOCore.cpu.read16(i+172),I=IodineGUI.Iodine.IOCore.cpu.read32(50355596);if(IodineGUI.Iodine.IOCore.cpu.write32(I+1168,this.money^o),!this.keyItemsPocket.get(360)||this.keyItemsPocket.get(259)||this.keyItemsPocket.get(272)||this.keyItemsPocket.set(259,1),"E"==e&&"C"==t){let e=this.tmCase.get(296),t=this.tmCase.get(344),i=this.keyItemsPocket.get(347);this.tmCase.delete(296),this.tmCase.delete(344),this.keyItemsPocket.delete(347),e&&this.tmCase.set(344,1),t&&this.keyItemsPocket.set(347,1),i&&this.tmCase.set(296,1)}else if("C"==e&&t&&"C"!=t){let e=this.tmCase.get(344),t=this.keyItemsPocket.get(347),i=this.tmCase.get(296);this.tmCase.delete(296),this.tmCase.delete(344),this.keyItemsPocket.delete(347),e&&this.tmCase.set(296,1),t&&this.tmCase.set(344,1),i&&this.keyItemsPocket.set(347,1)}this.writeItemSection(I,1376,120,this.itemPocket,r,!0),this.writeItemSection(I,1496,120,this.keyItemsPocket,r,!1),this.writeItemSection(I,1616,64,this.ballItemPocket,r,!0),this.writeItemSection(I,1680,256,this.tmCase,r,!0),this.writeItemSection(I,1936,184,this.berryPocket,r,!0)},BagStoreage.prototype.readItemSection=function(e,t,i,o,r){for(let I=0;I<t+i;I+=4){let i=IodineGUI.Iodine.IOCore.cpu.read16(e+t+I);if(0==i)break;let n=IodineGUI.Iodine.IOCore.cpu.read16(e+t+I+2)^r;o.set(i,n)}},BagStoreage.prototype.writeItemSection=function(e,t,i,o,r,I){var n=[...o];for(let o=0;o<t+i;o+=4){if(n.length>o/4){let i=n[o/4][0],I=n[o/4][1]^r;IodineGUI.Iodine.IOCore.cpu.write16(e+t+o,i),IodineGUI.Iodine.IOCore.cpu.write16(e+t+o+2,I)}else{if(!I)break;{let i=ITEM_DATA.Nothing.number,I=0^r;IodineGUI.Iodine.IOCore.cpu.write16(e+t+o,i),IodineGUI.Iodine.IOCore.cpu.write16(e+t+o+2,I)}}}};
//# sourceMappingURL=index.e1f9c7d4.js.map
