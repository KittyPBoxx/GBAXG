"use strict";function GameBoyAdvanceOBJRenderer(e){this.gfx=e}GameBoyAdvanceOBJRenderer.prototype.lookupXSize=[8,16,32,64,16,32,32,64,8,8,16,32],GameBoyAdvanceOBJRenderer.prototype.lookupYSize=[8,16,32,64,8,8,16,32,16,32,32,64],__VIEWS_SUPPORTED__?("function"==typeof getUint8Array(1).fill?(GameBoyAdvanceOBJRenderer.prototype.initialize=function(){this.paletteOBJ256=this.gfx.paletteOBJ256,this.paletteOBJ16=this.gfx.paletteOBJ16,this.VRAM=this.gfx.VRAM,this.cyclesToRender=1210,this.VRAM32=this.gfx.VRAM32,this.OAMRAM=getUint8Array(1024),this.OAMRAM16=getUint16View(this.OAMRAM),this.OAMRAM32=getInt32View(this.OAMRAM),this.scratchBuffer=getInt32ViewCustom(this.gfx.buffer,1280,1520),this.scratchWindowBuffer=getInt32Array(240),this.scratchOBJBuffer=getInt32ViewCustom(this.gfx.buffer,1536,1664),this.OBJMatrixParameters=getInt32Array(128),this.initializeOAMTable()},GameBoyAdvanceOBJRenderer.prototype.clearScratch=function(){this.scratchBuffer.fill(58720256),this.scratchWindowBuffer.fill(58720256)}):(GameBoyAdvanceOBJRenderer.prototype.initialize=function(){this.paletteOBJ256=this.gfx.paletteOBJ256,this.paletteOBJ16=this.gfx.paletteOBJ16,this.VRAM=this.gfx.VRAM,this.cyclesToRender=1210,this.VRAM32=this.gfx.VRAM32,this.OAMRAM=getUint8Array(1024),this.OAMRAM16=getUint16View(this.OAMRAM),this.OAMRAM32=getInt32View(this.OAMRAM),this.scratchBuffer=getInt32ViewCustom(this.gfx.buffer,1280,1520),this.scratchWindowBuffer=getInt32Array(240),this.scratchOBJBuffer=getInt32ViewCustom(this.gfx.buffer,1536,1664),this.clearingBuffer=getInt32Array(240),this.initializeClearingBuffer(),this.OBJMatrixParameters=getInt32Array(128),this.initializeOAMTable()},GameBoyAdvanceOBJRenderer.prototype.clearScratch=function(){this.scratchBuffer.set(this.clearingBuffer),this.scratchWindowBuffer.set(this.clearingBuffer)},GameBoyAdvanceOBJRenderer.prototype.initializeClearingBuffer=function(){for(var e=0;(0|e)<240;e=1+(0|e)|0)this.clearingBuffer[0|e]=58720256}),GameBoyAdvanceOBJRenderer.prototype.outputSpriteNormal=function(e,t,r){e|=0,t|=0,r|=0;for(var i=0;(0|e)<(0|t);e=1+(0|e)|0,i=1+(0|i)|0){var a=r|this.scratchOBJBuffer[0|i];(0|e)>-1&&(58720256&a)<(58720256&this.scratchBuffer[0|e])&&(this.scratchBuffer[0|e]=0|a)}},GameBoyAdvanceOBJRenderer.prototype.outputSpriteFlipped=function(e,t,r,i){e|=0,t|=0,r|=0;for(var a=(0|(i|=0))-1|0;(0|e)<(0|t);e=1+(0|e)|0,a=(0|a)-1|0){var s=r|this.scratchOBJBuffer[0|a];(0|e)>-1&&(58720256&s)<(58720256&this.scratchBuffer[0|e])&&(this.scratchBuffer[0|e]=0|s)}},GameBoyAdvanceOBJRenderer.prototype.outputSpriteNormalOBJWIN=function(e,t){e|=0,t|=0;for(var r=0;(0|e)<(0|t);e=1+(0|e)|0,r=1+(0|r)|0)(0|e)>-1&&0!=(0|this.scratchOBJBuffer[0|r])&&(this.scratchWindowBuffer[0|e]=0)},GameBoyAdvanceOBJRenderer.prototype.outputSpriteFlippedOBJWIN=function(e,t,r){e|=0,t|=0;for(var i=(0|(r|=0))-1|0;(0|e)<(0|t);e=1+(0|e)|0,i=(0|i)-1|0)(0|e)>-1&&0!=(0|this.scratchOBJBuffer[0|i])&&(this.scratchWindowBuffer[0|e]=0)}):(GameBoyAdvanceOBJRenderer.prototype.initialize=function(){this.paletteOBJ256=this.gfx.paletteOBJ256,this.paletteOBJ16=this.gfx.paletteOBJ16,this.VRAM=this.gfx.VRAM,this.cyclesToRender=1210,this.OAMRAM=getUint8Array(1024),this.offset=1280,this.scratchBuffer=this.gfx.buffer,this.scratchWindowBuffer=getInt32Array(240),this.scratchOBJBuffer=getInt32Array(128),this.gfx.mosaicRenderer.attachOBJBuffer(this.scratchOBJBuffer),this.OBJMatrixParameters=getInt32Array(128),this.initializeOAMTable()},GameBoyAdvanceOBJRenderer.prototype.clearScratch=function(){for(var e=0;e<240;++e)this.scratchBuffer[e|this.offset]=58720256,this.scratchWindowBuffer[e]=58720256},GameBoyAdvanceOBJRenderer.prototype.outputSpriteNormal=function(e,t,r){for(var i=0;e<t;++e,++i){var a=r|this.scratchOBJBuffer[i];(0|e)>-1&&(58720256&a)<(58720256&this.scratchBuffer[e|this.offset])&&(this.scratchBuffer[e|this.offset]=a)}},GameBoyAdvanceOBJRenderer.prototype.outputSpriteFlipped=function(e,t,r,i){for(var a=i-1;e<t;++e,--a){var s=r|this.scratchOBJBuffer[a];e>-1&&(58720256&s)<(58720256&this.scratchBuffer[e|this.offset])&&(this.scratchBuffer[e|this.offset]=s)}},GameBoyAdvanceOBJRenderer.prototype.outputSpriteNormalOBJWIN=function(e,t){for(var r=0;e<t;++e,++r)e>-1&&0!=this.scratchOBJBuffer[r]&&(this.scratchWindowBuffer[e]=0)},GameBoyAdvanceOBJRenderer.prototype.outputSpriteFlippedOBJWIN=function(e,t,r){for(var i=r-1;e<t;++e,--i)e>-1&&0!=this.scratchOBJBuffer[i]&&(this.scratchWindowBuffer[e]=0)}),GameBoyAdvanceOBJRenderer.prototype.initializeOAMTable=function(){this.OAMTable=[];for(var e=0;(0|e)<128;e=1+(0|e)|0)this.OAMTable[0|e]=this.makeOAMAttributeTable()},"object"==typeof TypedObject&&"object"==typeof TypedObject.StructType?GameBoyAdvanceOBJRenderer.prototype.makeOAMAttributeTable=function(){return new TypedObject.StructType({ycoord:TypedObject.int32,matrix2D:TypedObject.int32,doubleSizeOrDisabled:TypedObject.int32,mode:TypedObject.int32,mosaic:TypedObject.int32,monolithicPalette:TypedObject.int32,shape:TypedObject.int32,xcoord:TypedObject.int32,matrixParameters:TypedObject.int32,horizontalFlip:TypedObject.int32,verticalFlip:TypedObject.int32,size:TypedObject.int32,tileNumber:TypedObject.int32,priority:TypedObject.int32,paletteNumber:TypedObject.int32})}:GameBoyAdvanceOBJRenderer.prototype.makeOAMAttributeTable=function(){return{ycoord:0,matrix2D:0,doubleSizeOrDisabled:0,mode:0,mosaic:0,monolithicPalette:0,shape:0,xcoord:0,matrixParameters:0,horizontalFlip:0,verticalFlip:0,size:0,tileNumber:0,priority:0,paletteNumber:0}},GameBoyAdvanceOBJRenderer.prototype.renderScanLine=function(e){e|=0,this.performRenderLoop(0|e)},GameBoyAdvanceOBJRenderer.prototype.performRenderLoop=function(e){e|=0,this.clearScratch();for(var t=0|this.cyclesToRender,r=0;(0|r)<128;r=1+(0|r)|0)t=0|this.renderSprite(0|e,this.OAMTable[0|r],0|t)},GameBoyAdvanceOBJRenderer.prototype.renderSprite=function(e,t,r){if(e|=0,r|=0,this.isDrawable(t)){0!=(0|t.mosaic)&&(e=(0|e)-(0|this.gfx.mosaicRenderer.getOBJMosaicYOffset(0|e))|0);var i=this.lookupXSize[t.shape<<2|t.size]<<(0|t.doubleSizeOrDisabled),a=this.lookupYSize[t.shape<<2|t.size]<<(0|t.doubleSizeOrDisabled),s=0|t.ycoord,o=(0|e)-(0|s)|0;if(((0|o)<0||((0|s)+(0|a)|0)>256)&&(o=256+(0|o)|0),(o&(a=(0|a)-1|0))==(0|o)&&(0|(r=0|this.computeCycles(0|r,0|t.matrix2D,0|i)))>=0)switch(0|t.mode){case 0:this.renderRegularSprite(t,0|i,0|a,0|o);break;case 1:this.renderSemiTransparentSprite(t,0|i,0|a,0|o);break;case 2:this.renderOBJWINSprite(t,0|i,0|a,0|o)}}return 0|r},GameBoyAdvanceOBJRenderer.prototype.computeCycles=function(e,t,r){return e|=0,r|=0,0|(e=0!=(0|(t|=0))?(0|e)-(0|(r=10+(0|(r<<=1))|0))|0:(0|e)-(0|r)|0)},GameBoyAdvanceOBJRenderer.prototype.renderRegularSprite=function(e,t,r,i){t|=0,r|=0,i|=0,0!=(0|e.matrix2D)?this.renderMatrixSprite(e,0|t,1+(0|r)|0,0|i):this.renderNormalSprite(e,0|t,0|r,0|i),this.outputSpriteToScratch(e,0|t)},GameBoyAdvanceOBJRenderer.prototype.renderSemiTransparentSprite=function(e,t,r,i){t|=0,r|=0,i|=0,0!=(0|e.matrix2D)?this.renderMatrixSprite(e,0|t,1+(0|r)|0,0|i):this.renderNormalSprite(e,0|t,0|r,0|i),this.outputSemiTransparentSpriteToScratch(e,0|t)},GameBoyAdvanceOBJRenderer.prototype.renderOBJWINSprite=function(e,t,r,i){t|=0,r|=0,i|=0,0!=(0|e.matrix2D)?this.renderMatrixSpriteOBJWIN(e,0|t,1+(0|r)|0,0|i):this.renderNormalSpriteOBJWIN(e,0|t,0|r,0|i),this.outputSpriteToOBJWINScratch(e,0|t)},"function"==typeof Math.imul?(GameBoyAdvanceOBJRenderer.prototype.renderMatrixSprite=function(e,t,r,i){var a=0|-((t|=0)>>1),s=(0|(i|=0))-((r|=0)>>1)|0,o=t>>(0|e.doubleSizeOrDisabled),h=o<<8,c=r>>(0|e.doubleSizeOrDisabled)<<8,n=0|this.OBJMatrixParameters[0|e.matrixParameters],B=0|this.OBJMatrixParameters[1|e.matrixParameters],f=0|this.OBJMatrixParameters[2|e.matrixParameters],p=0|this.OBJMatrixParameters[3|e.matrixParameters],O=(0|(0|Math.imul(0|n,0|a)))+(0|(0|Math.imul(0|B,0|s)))|0;O=(0|O)+(h>>1)|0;var u=(0|(0|Math.imul(0|f,0|a)))+(0|(0|Math.imul(0|p,0|s)))|0;u=(0|u)+(c>>1)|0;for(var l=0;(0|l)<(0|t);l=l+1|0,O=(0|O)+(0|n)|0,u=(0|u)+(0|f)|0)this.scratchOBJBuffer[0|l]=(0|O)>=0&&(0|u)>=0&&(0|O)<(0|h)&&(0|u)<(0|c)?0|this.fetchMatrixPixel(e,O>>8,u>>8,0|o):58720256},GameBoyAdvanceOBJRenderer.prototype.renderMatrixSpriteOBJWIN=function(e,t,r,i){var a=0|-((t|=0)>>1),s=(0|(i|=0))-((r|=0)>>1)|0,o=t>>(0|e.doubleSizeOrDisabled),h=o<<8,c=r>>(0|e.doubleSizeOrDisabled)<<8,n=0|this.OBJMatrixParameters[0|e.matrixParameters],B=0|this.OBJMatrixParameters[1|e.matrixParameters],f=0|this.OBJMatrixParameters[2|e.matrixParameters],p=0|this.OBJMatrixParameters[3|e.matrixParameters],O=(0|(0|Math.imul(0|n,0|a)))+(0|(0|Math.imul(0|B,0|s)))|0;O=(0|O)+(h>>1)|0;var u=(0|(0|Math.imul(0|f,0|a)))+(0|(0|Math.imul(0|p,0|s)))|0;u=(0|u)+(c>>1)|0;for(var l=0;(0|l)<(0|t);l=l+1|0,O=(0|O)+(0|n)|0,u=(0|u)+(0|f)|0)this.scratchOBJBuffer[0|l]=(0|O)>=0&&(0|u)>=0&&(0|O)<(0|h)&&(0|u)<(0|c)?0|this.fetchMatrixPixelOBJWIN(e,O>>8,u>>8,0|o):0}):(GameBoyAdvanceOBJRenderer.prototype.renderMatrixSprite=function(e,t,r,i){for(var a=-(t>>1),s=i-(r>>1),o=t>>e.doubleSizeOrDisabled,h=o<<8,c=r>>e.doubleSizeOrDisabled<<8,n=this.OBJMatrixParameters[e.matrixParameters],B=this.OBJMatrixParameters[1|e.matrixParameters],f=this.OBJMatrixParameters[2|e.matrixParameters],p=n*a+B*s+(h>>1),O=f*a+this.OBJMatrixParameters[3|e.matrixParameters]*s+(c>>1),u=0;u<t;++u,p+=n,O+=f)this.scratchOBJBuffer[u]=p>=0&&O>=0&&p<h&&O<c?this.fetchMatrixPixel(e,p>>8,O>>8,o):58720256},GameBoyAdvanceOBJRenderer.prototype.renderMatrixSpriteOBJWIN=function(e,t,r,i){for(var a=-(t>>1),s=i-(r>>1),o=t>>e.doubleSizeOrDisabled,h=o<<8,c=r>>e.doubleSizeOrDisabled<<8,n=this.OBJMatrixParameters[e.matrixParameters],B=this.OBJMatrixParameters[1|e.matrixParameters],f=this.OBJMatrixParameters[2|e.matrixParameters],p=n*a+B*s+(h>>1),O=f*a+this.OBJMatrixParameters[3|e.matrixParameters]*s+(c>>1),u=0;u<t;++u,p+=n,O+=f)this.scratchOBJBuffer[u]=p>=0&&O>=0&&p<h&&O<c?this.fetchMatrixPixelOBJWIN(e,p>>8,O>>8,o):0}),GameBoyAdvanceOBJRenderer.prototype.fetchMatrixPixel=function(e,t,r,i){var a;return t|=0,r|=0,i|=0,0!=(0|e.monolithicPalette)?(a=(0|(a=0|this.tileNumberToAddress256(0|e.tileNumber,0|i,0|r)))+(0|this.tileRelativeAddressOffset(0|t,0|r))|0,0|this.paletteOBJ256[0|this.VRAM[0|a]]):(a=(0|(a=0|this.tileNumberToAddress16(0|e.tileNumber,0|i,0|r)))+(this.tileRelativeAddressOffset(0|t,0|r)>>1|0)|0,0==(1&t)?0|this.paletteOBJ16[e.paletteNumber|15&this.VRAM[0|a]]:0|this.paletteOBJ16[e.paletteNumber|this.VRAM[0|a]>>4])},GameBoyAdvanceOBJRenderer.prototype.fetchMatrixPixelOBJWIN=function(e,t,r,i){var a;return t|=0,r|=0,i|=0,0!=(0|e.monolithicPalette)?(a=(0|(a=0|this.tileNumberToAddress256(0|e.tileNumber,0|i,0|r)))+(0|this.tileRelativeAddressOffset(0|t,0|r))|0,0|this.VRAM[0|a]):(a=(0|(a=0|this.tileNumberToAddress16(0|e.tileNumber,0|i,0|r)))+(this.tileRelativeAddressOffset(0|t,0|r)>>1|0)|0,0==(1&t)?15&this.VRAM[0|a]:this.VRAM[0|a]>>4)},GameBoyAdvanceOBJRenderer.prototype.tileRelativeAddressOffset=function(e,t){return((7&(t|=0))+(-8&(e|=0))<<3)+(7&e)|0},GameBoyAdvanceOBJRenderer.prototype.renderNormalSprite=function(e,t,r,i){var a;(t|=0,r|=0,i|=0,0!=(0|e.verticalFlip)&&(i=(0|r)-(0|i)|0),0!=(0|e.monolithicPalette))?(a=(0|(a=0|this.tileNumberToAddress256(0|e.tileNumber,0|t,0|i)))+((7&i)<<3)|0,this.render256ColorPaletteSprite(0|a,0|t)):(a=(0|(a=0|this.tileNumberToAddress16(0|e.tileNumber,0|t,0|i)))+((7&i)<<2)|0,this.render16ColorPaletteSprite(0|a,0|t,0|e.paletteNumber))},GameBoyAdvanceOBJRenderer.prototype.renderNormalSpriteOBJWIN=function(e,t,r,i){var a;(t|=0,r|=0,i|=0,0!=(0|e.verticalFlip)&&(i=(0|r)-(0|i)|0),0!=(0|e.monolithicPalette))?(a=(0|(a=0|this.tileNumberToAddress256(0|e.tileNumber,0|t,0|i)))+((7&i)<<3)|0,this.render256ColorPaletteSpriteOBJWIN(0|a,0|t)):(a=(0|(a=0|this.tileNumberToAddress16(0|e.tileNumber,0|t,0|i)))+((7&i)<<2)|0,this.render16ColorPaletteSpriteOBJWIN(0|a,0|t))},__LITTLE_ENDIAN__?(GameBoyAdvanceOBJRenderer.prototype.render256ColorPaletteSprite=function(e,t){e>>=2,t|=0;for(var r=0,i=0;(0|i)<(0|t);i=8+(0|i)|0)r=0|this.VRAM32[0|e],this.scratchOBJBuffer[0|i]=0|this.paletteOBJ256[255&r],this.scratchOBJBuffer[1|i]=0|this.paletteOBJ256[r>>8&255],this.scratchOBJBuffer[2|i]=0|this.paletteOBJ256[r>>16&255],this.scratchOBJBuffer[3|i]=0|this.paletteOBJ256[r>>>24],r=0|this.VRAM32[1|e],this.scratchOBJBuffer[4|i]=0|this.paletteOBJ256[255&r],this.scratchOBJBuffer[5|i]=0|this.paletteOBJ256[r>>8&255],this.scratchOBJBuffer[6|i]=0|this.paletteOBJ256[r>>16&255],this.scratchOBJBuffer[7|i]=0|this.paletteOBJ256[r>>>24],e=16+(0|e)|0},GameBoyAdvanceOBJRenderer.prototype.render256ColorPaletteSpriteOBJWIN=function(e,t){e>>=2,t|=0;for(var r=0,i=0;(0|i)<(0|t);i=8+(0|i)|0)r=0|this.VRAM32[0|e],this.scratchOBJBuffer[0|i]=255&r,this.scratchOBJBuffer[1|i]=r>>8&255,this.scratchOBJBuffer[2|i]=r>>16&255,this.scratchOBJBuffer[3|i]=r>>>24,r=0|this.VRAM32[1|e],this.scratchOBJBuffer[4|i]=255&r,this.scratchOBJBuffer[5|i]=r>>8&255,this.scratchOBJBuffer[6|i]=r>>16&255,this.scratchOBJBuffer[7|i]=r>>>24,e=16+(0|e)|0},GameBoyAdvanceOBJRenderer.prototype.render16ColorPaletteSprite=function(e,t,r){e>>=2,t|=0,r|=0;for(var i=0,a=0;(0|a)<(0|t);a=8+(0|a)|0)i=0|this.VRAM32[0|e],this.scratchOBJBuffer[0|a]=0|this.paletteOBJ16[r|15&i],this.scratchOBJBuffer[1|a]=0|this.paletteOBJ16[r|i>>4&15],this.scratchOBJBuffer[2|a]=0|this.paletteOBJ16[r|i>>8&15],this.scratchOBJBuffer[3|a]=0|this.paletteOBJ16[r|i>>12&15],this.scratchOBJBuffer[4|a]=0|this.paletteOBJ16[r|i>>16&15],this.scratchOBJBuffer[5|a]=0|this.paletteOBJ16[r|i>>20&15],this.scratchOBJBuffer[6|a]=0|this.paletteOBJ16[r|i>>24&15],this.scratchOBJBuffer[7|a]=0|this.paletteOBJ16[r|i>>>28],e=8+(0|e)|0},GameBoyAdvanceOBJRenderer.prototype.render16ColorPaletteSpriteOBJWIN=function(e,t){e>>=2,t|=0;for(var r=0,i=0;(0|i)<(0|t);i=8+(0|i)|0)r=0|this.VRAM32[0|e],this.scratchOBJBuffer[0|i]=15&r,this.scratchOBJBuffer[1|i]=r>>4&15,this.scratchOBJBuffer[2|i]=r>>8&15,this.scratchOBJBuffer[3|i]=r>>12&15,this.scratchOBJBuffer[4|i]=r>>16&15,this.scratchOBJBuffer[5|i]=r>>20&15,this.scratchOBJBuffer[6|i]=r>>24&15,this.scratchOBJBuffer[7|i]=r>>>28,e=8+(0|e)|0}):(GameBoyAdvanceOBJRenderer.prototype.render256ColorPaletteSprite=function(e,t){for(var r=0;r<t;)this.scratchOBJBuffer[r++]=this.paletteOBJ256[this.VRAM[e++]],this.scratchOBJBuffer[r++]=this.paletteOBJ256[this.VRAM[e++]],this.scratchOBJBuffer[r++]=this.paletteOBJ256[this.VRAM[e++]],this.scratchOBJBuffer[r++]=this.paletteOBJ256[this.VRAM[e++]],this.scratchOBJBuffer[r++]=this.paletteOBJ256[this.VRAM[e++]],this.scratchOBJBuffer[r++]=this.paletteOBJ256[this.VRAM[e++]],this.scratchOBJBuffer[r++]=this.paletteOBJ256[this.VRAM[e++]],this.scratchOBJBuffer[r++]=this.paletteOBJ256[this.VRAM[e]],e+=57},GameBoyAdvanceOBJRenderer.prototype.render256ColorPaletteSpriteOBJWIN=function(e,t){for(var r=0;r<t;)this.scratchOBJBuffer[r++]=this.VRAM[e++],this.scratchOBJBuffer[r++]=this.VRAM[e++],this.scratchOBJBuffer[r++]=this.VRAM[e++],this.scratchOBJBuffer[r++]=this.VRAM[e++],this.scratchOBJBuffer[r++]=this.VRAM[e++],this.scratchOBJBuffer[r++]=this.VRAM[e++],this.scratchOBJBuffer[r++]=this.VRAM[e++],this.scratchOBJBuffer[r++]=this.VRAM[e],e+=57},GameBoyAdvanceOBJRenderer.prototype.render16ColorPaletteSprite=function(e,t,r){for(var i=0,a=0;a<t;)i=this.VRAM[e++],this.scratchOBJBuffer[a++]=this.paletteOBJ16[r|15&i],this.scratchOBJBuffer[a++]=this.paletteOBJ16[r|i>>4],i=this.VRAM[e++],this.scratchOBJBuffer[a++]=this.paletteOBJ16[r|15&i],this.scratchOBJBuffer[a++]=this.paletteOBJ16[r|i>>4],i=this.VRAM[e++],this.scratchOBJBuffer[a++]=this.paletteOBJ16[r|15&i],this.scratchOBJBuffer[a++]=this.paletteOBJ16[r|i>>4],i=this.VRAM[e],this.scratchOBJBuffer[a++]=this.paletteOBJ16[r|15&i],this.scratchOBJBuffer[a++]=this.paletteOBJ16[r|i>>4],e+=29},GameBoyAdvanceOBJRenderer.prototype.render16ColorPaletteSpriteOBJWIN=function(e,t){for(var r=0,i=0;i<t;)r=this.VRAM[e++],this.scratchOBJBuffer[i++]=15&r,this.scratchOBJBuffer[i++]=r>>4,r=this.VRAM[e++],this.scratchOBJBuffer[i++]=15&r,this.scratchOBJBuffer[i++]=r>>4,r=this.VRAM[e++],this.scratchOBJBuffer[i++]=15&r,this.scratchOBJBuffer[i++]=r>>4,r=this.VRAM[e],this.scratchOBJBuffer[i++]=15&r,this.scratchOBJBuffer[i++]=r>>4,e+=29}),"function"==typeof Math.imul?(GameBoyAdvanceOBJRenderer.prototype.tileNumberToAddress256=function(e,t,r){return e|=0,t|=0,r|=0,65536+((e=0==(64&this.gfx.displayControl)?(-2&e)+(0|Math.imul(r>>3,32))|0:(0|e)+(0|Math.imul(r>>3,t>>2))|0)<<5)|0},GameBoyAdvanceOBJRenderer.prototype.tileNumberToAddress16=function(e,t,r){return e|=0,t|=0,r|=0,65536+((e=0==(64&this.gfx.displayControl)?(0|e)+(0|Math.imul(r>>3,32))|0:(0|e)+(0|Math.imul(r>>3,t>>3))|0)<<5)|0}):(GameBoyAdvanceOBJRenderer.prototype.tileNumberToAddress256=function(e,t,r){return 0==(64&this.gfx.displayControl)?(e&=-2,e+=32*(r>>3)):e+=(r>>3)*(t>>2),65536+(e<<5)},GameBoyAdvanceOBJRenderer.prototype.tileNumberToAddress16=function(e,t,r){return 0==(64&this.gfx.displayControl)?e+=32*(r>>3):e+=(r>>3)*(t>>3),65536+(e<<5)}),GameBoyAdvanceOBJRenderer.prototype.outputSpriteToScratch=function(e,t){t|=0;var r=0|e.xcoord;(0|r)>(512-(0|t)|0)&&(r=(0|r)-512|0),0!=(0|e.mosaic)&&this.gfx.mosaicRenderer.renderOBJMosaicHorizontal(0|r,0|t);var i=0|Math.min((0|r)+(0|t)|0,240),a=e.priority<<23|1048576;0==(0|e.horizontalFlip)||0!=(0|e.matrix2D)?this.outputSpriteNormal(0|r,0|i,0|a):this.outputSpriteFlipped(0|r,0|i,0|a,0|t)},GameBoyAdvanceOBJRenderer.prototype.outputSemiTransparentSpriteToScratch=function(e,t){t|=0;var r=0|e.xcoord;(0|r)>(512-(0|t)|0)&&(r=(0|r)-512|0),0!=(0|e.mosaic)&&this.gfx.mosaicRenderer.renderOBJMosaicHorizontal(0|r,0|t);var i=0|Math.min((0|r)+(0|t)|0,240),a=e.priority<<23|5242880;0==(0|e.horizontalFlip)||0!=(0|e.matrix2D)?this.outputSpriteNormal(0|r,0|i,0|a):this.outputSpriteFlipped(0|r,0|i,0|a,0|t)},GameBoyAdvanceOBJRenderer.prototype.outputSpriteToOBJWINScratch=function(e,t){t|=0;var r=0|e.xcoord;(0|r)>(512-(0|t)|0)&&(r=(0|r)-512|0),0!=(0|e.mosaic)&&this.gfx.mosaicRenderer.renderOBJMosaicHorizontal(0|r,0|t);var i=0|Math.min((0|r)+(0|t)|0,240);0==(0|e.horizontalFlip)||0!=(0|e.matrix2D)?this.outputSpriteNormalOBJWIN(0|r,0|i):this.outputSpriteFlippedOBJWIN(0|r,0|i,0|t)},GameBoyAdvanceOBJRenderer.prototype.isDrawable=function(e){return(0|e.mode)<=2&&(0==(0|e.doubleSizeOrDisabled)||0!=(0|e.matrix2D))&&(0|e.shape)<3&&((7&this.gfx.displayControl)<3||(0|e.tileNumber)>=512)},GameBoyAdvanceOBJRenderer.prototype.setHBlankIntervalFreeStatus=function(e){e|=0,this.cyclesToRender=0!=(0|e)?954:1210},GameBoyAdvanceOBJRenderer.prototype.readOAM=function(e){return 0|this.OAMRAM[1023&e]},__LITTLE_ENDIAN__?(GameBoyAdvanceOBJRenderer.prototype.writeOAM16=function(e,t){e|=0,t|=0;var r=this.OAMTable[e>>2];switch(3&e){case 0:r.ycoord=255&t,r.matrix2D=256&t,r.doubleSizeOrDisabled=(512&t)>>9,r.mode=t>>10&3,r.mosaic=4096&t,r.monolithicPalette=8192&t,r.shape=t>>14;break;case 1:r.xcoord=511&t,r.matrixParameters=t>>7&124,r.horizontalFlip=4096&t,r.verticalFlip=8192&t,r.size=t>>14;break;case 2:r.tileNumber=1023&t,r.priority=t>>10&3,r.paletteNumber=t>>8&240;break;default:this.OBJMatrixParameters[e>>2]=t<<16>>16}this.OAMRAM16[0|e]=65535&t},GameBoyAdvanceOBJRenderer.prototype.writeOAM32=function(e,t){e|=0,t|=0;var r=this.OAMTable[e>>1];0==(1&e)?(r.ycoord=255&t,r.matrix2D=256&t,r.doubleSizeOrDisabled=(512&t)>>9,r.mode=t>>10&3,r.mosaic=4096&t,r.monolithicPalette=8192&t,r.shape=t>>14&3,r.xcoord=t>>16&511,r.matrixParameters=t>>23&124,r.horizontalFlip=268435456&t,r.verticalFlip=536870912&t,r.size=t>>>30):(r.tileNumber=1023&t,r.priority=t>>10&3,r.paletteNumber=t>>8&240,this.OBJMatrixParameters[e>>1]=t>>16),this.OAMRAM32[0|e]=0|t},GameBoyAdvanceOBJRenderer.prototype.readOAM16=function(e){return e|=0,0|this.OAMRAM16[511&e]},GameBoyAdvanceOBJRenderer.prototype.readOAM32=function(e){return e|=0,0|this.OAMRAM32[255&e]}):(GameBoyAdvanceOBJRenderer.prototype.writeOAM16=function(e,t){e|=0,t|=0,e&=511;var r=this.OAMTable[e>>2];switch(3&e){case 0:r.ycoord=255&t,r.matrix2D=256&t,r.doubleSizeOrDisabled=(512&t)>>9,r.mode=t>>10&3,r.mosaic=4096&t,r.monolithicPalette=8192&t,r.shape=t>>14;break;case 1:r.xcoord=511&t,r.matrixParameters=t>>7&124,r.horizontalFlip=4096&t,r.verticalFlip=8192&t,r.size=t>>14;break;case 2:r.tileNumber=1023&t,r.priority=t>>10&3,r.paletteNumber=t>>8&240;break;default:this.OBJMatrixParameters[e>>2]=t<<16>>16}e<<=1,this.OAMRAM[0|e]=255&t,this.OAMRAM[1|e]=t>>8},GameBoyAdvanceOBJRenderer.prototype.writeOAM32=function(e,t){e|=0,t|=0,e&=255;var r=this.OAMTable[e>>1];0==(1&e)?(r.ycoord=255&t,r.matrix2D=256&t,r.doubleSizeOrDisabled=(512&t)>>9,r.mode=t>>10&3,r.mosaic=4096&t,r.monolithicPalette=8192&t,r.shape=t>>14&3,r.xcoord=t>>16&511,r.matrixParameters=t>>23&124,r.horizontalFlip=268435456&t,r.verticalFlip=536870912&t,r.size=t>>>30):(r.tileNumber=1023&t,r.priority=t>>10&3,r.paletteNumber=t>>8&240,this.OBJMatrixParameters[e>>1]=t>>16),e<<=2,this.OAMRAM[0|e]=255&t,this.OAMRAM[1|e]=t>>8&255,this.OAMRAM[2|e]=t>>16&255,this.OAMRAM[3|e]=t>>>24},GameBoyAdvanceOBJRenderer.prototype.readOAM16=function(e){return e&=511,e<<=1,this.OAMRAM[e]|this.OAMRAM[1|e]<<8},GameBoyAdvanceOBJRenderer.prototype.readOAM32=function(e){return e&=255,e<<=2,this.OAMRAM[e]|this.OAMRAM[1|e]<<8|this.OAMRAM[2|e]<<16|this.OAMRAM[3|e]<<24});
//# sourceMappingURL=index.63948b2f.js.map
