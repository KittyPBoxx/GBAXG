"use strict";function GameBoyAdvanceColorEffectsRenderer(e){this.effectsTarget1=0,this.colorEffectsType=0,this.effectsTarget2=0,this.initialize(e)}"object"==typeof SIMD&&"function"==typeof SIMD.Int32x4?(GameBoyAdvanceColorEffectsRenderer.prototype.initialize=function(e){this.alphaBlendAmountTarget1=SIMD.Int32x4.splat(0),this.alphaBlendAmountTarget2=SIMD.Int32x4.splat(0),this.brightnessEffectAmount=SIMD.Int32x4.splat(0),this.brightnessEffectAmountReverse=SIMD.Int32x4.splat(16),this.buffer=e},GameBoyAdvanceColorEffectsRenderer.prototype.pixelMask=SIMD.Int32x4.splat(31),GameBoyAdvanceColorEffectsRenderer.prototype.temporaryPixelBuffer=new Int32Array(4),GameBoyAdvanceColorEffectsRenderer.prototype.alphaBlend=function(e,t){e|=0,t|=0;var r=SIMD.Int32x4(e>>10,e>>5,e,0),s=SIMD.Int32x4(t>>10,t>>5,t,0);r=SIMD.Int32x4.and(r,this.pixelMask),s=SIMD.Int32x4.and(s,this.pixelMask),r=SIMD.Int32x4.mul(r,this.alphaBlendAmountTarget1),s=SIMD.Int32x4.mul(s,this.alphaBlendAmountTarget2);var i=SIMD.Int32x4.add(r,s);i=SIMD.Int32x4.shiftRightByScalar(i,4);var o=SIMD.Int32x4.lessThanOrEqual(i,this.pixelMask);return i=SIMD.Int32x4.select(o,i,this.pixelMask),SIMD.Int32x4.store(this.temporaryPixelBuffer,0,i),this.temporaryPixelBuffer[0]<<10|this.temporaryPixelBuffer[1]<<5|this.temporaryPixelBuffer[2]},GameBoyAdvanceColorEffectsRenderer.prototype.brightnessIncrease=function(e){e|=0;var t=SIMD.Int32x4(e>>10,e>>5,e,0);t=SIMD.Int32x4.and(t,this.pixelMask);var r=SIMD.Int32x4.sub(this.pixelMask,t);return r=SIMD.Int32x4.mul(r,this.brightnessEffectAmount),r=SIMD.Int32x4.shiftRightByScalar(r,4),t=SIMD.Int32x4.add(t,r),SIMD.Int32x4.store(this.temporaryPixelBuffer,0,t),this.temporaryPixelBuffer[0]<<10|this.temporaryPixelBuffer[1]<<5|this.temporaryPixelBuffer[2]},GameBoyAdvanceColorEffectsRenderer.prototype.brightnessDecrease=function(e){e|=0;var t=SIMD.Int32x4(e>>10,e>>5,e,0);return t=SIMD.Int32x4.and(t,this.pixelMask),t=SIMD.Int32x4.mul(t,this.brightnessEffectAmountReverse),t=SIMD.Int32x4.shiftRightByScalar(t,4),SIMD.Int32x4.store(this.temporaryPixelBuffer,0,t),this.temporaryPixelBuffer[0]<<10|this.temporaryPixelBuffer[1]<<5|this.temporaryPixelBuffer[2]},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDALPHA8_0=function(e){var t=31&(e|=0);this.alphaBlendAmountTarget1=SIMD.Int32x4.splat(0|Math.min(0|t,16))},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDALPHA8_1=function(e){var t=31&(e|=0);this.alphaBlendAmountTarget2=SIMD.Int32x4.splat(0|Math.min(0|t,16))},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDALPHA16=function(e){var t=31&(e|=0);this.alphaBlendAmountTarget1=SIMD.Int32x4.splat(0|Math.min(0|t,16));var r=e>>8&31;this.alphaBlendAmountTarget2=SIMD.Int32x4.splat(0|Math.min(0|r,16))},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDCNT32=function(e){e|=0,this.effectsTarget1=(63&e)<<16,this.colorEffectsType=e>>6&3,this.effectsTarget2=(16128&e)<<8;var t=e>>16&31;this.alphaBlendAmountTarget1=SIMD.Int32x4.splat(0|Math.min(0|t,16));var r=e>>24&31;this.alphaBlendAmountTarget2=SIMD.Int32x4.splat(0|Math.min(0|r,16))},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDY8=function(e){e|=0;e=0|Math.min(31&e,16);this.brightnessEffectAmount=SIMD.Int32x4.splat(0|e),this.brightnessEffectAmountReverse=SIMD.Int32x4.splat(16-(0|e)|0)},GameBoyAdvanceColorEffectsRenderer.prototype.processFullNormalEffectsNoSprites=function(){for(var e=0;(0|e)<240;e=4+(0|e)|0)this.buffer[0|e]=this.processPixelNormal(0|this.buffer[1792|e],0|this.buffer[2048|e]),this.buffer[1|e]=this.processPixelNormal(0|this.buffer[1793|e],0|this.buffer[2049|e]),this.buffer[2|e]=this.processPixelNormal(0|this.buffer[1794|e],0|this.buffer[2050|e]),this.buffer[3|e]=this.processPixelNormal(0|this.buffer[1795|e],0|this.buffer[2051|e])},GameBoyAdvanceColorEffectsRenderer.prototype.processWindowNormalEffectsNoSprites=function(e,t){for(e|=0,t|=0;(0|e)<(0|t);)this.buffer[0|e]=this.processPixelNormal(0|this.buffer[1792|e],0|this.buffer[2048|e]),e=1+(0|e)|0},GameBoyAdvanceColorEffectsRenderer.prototype.processFullNormalEffectsWithSprites=function(){for(var e=0;(0|e)<240;e=4+(0|e)|0)this.buffer[0|e]=this.processPixelTestFull(0|this.buffer[1792|e],0|this.buffer[2048|e]),this.buffer[1|e]=this.processPixelTestFull(0|this.buffer[1793|e],0|this.buffer[2049|e]),this.buffer[2|e]=this.processPixelTestFull(0|this.buffer[1794|e],0|this.buffer[2050|e]),this.buffer[3|e]=this.processPixelTestFull(0|this.buffer[1795|e],0|this.buffer[2051|e])},GameBoyAdvanceColorEffectsRenderer.prototype.processWindowNormalEffectsWithSprites=function(e,t){for(e|=0,t|=0;(0|e)<(0|t);)this.buffer[0|e]=this.processPixelTestFull(0|this.buffer[1792|e],0|this.buffer[2048|e]),e=1+(0|e)|0},GameBoyAdvanceColorEffectsRenderer.prototype.processFullNoEffectsWithSprites=function(){for(var e=0;(0|e)<240;e=4+(0|e)|0)this.buffer[0|e]=this.processPixelTestSprite(0|this.buffer[1792|e],0|this.buffer[2048|e]),this.buffer[1|e]=this.processPixelTestSprite(0|this.buffer[1793|e],0|this.buffer[2049|e]),this.buffer[2|e]=this.processPixelTestSprite(0|this.buffer[1794|e],0|this.buffer[2050|e]),this.buffer[3|e]=this.processPixelTestSprite(0|this.buffer[1795|e],0|this.buffer[2051|e])},GameBoyAdvanceColorEffectsRenderer.prototype.processWindowNoEffectsWithSprites=function(e,t){for(e|=0,t|=0;(0|e)<(0|t);)this.buffer[0|e]=this.processPixelTestSprite(0|this.buffer[1792|e],0|this.buffer[2048|e]),e=1+(0|e)|0},GameBoyAdvanceColorEffectsRenderer.prototype.processPixelTestFull=function(e,t){return e|=0,0==(4194304&(t|=0))?0|this.processPixelNormal(0|e,0|t):0|this.processPixelSprite(0|e,0|t)},GameBoyAdvanceColorEffectsRenderer.prototype.processPixelTestSprite=function(e,t){return e|=0,0==(4194304&(t|=0))?0|t:0|this.processPixelSprite(0|e,0|t)}):(GameBoyAdvanceColorEffectsRenderer.prototype.initialize=function(e){this.alphaBlendAmountTarget1=0,this.alphaBlendAmountTarget2=0,this.brightnessEffectAmount=0},"function"==typeof Math.imul?(GameBoyAdvanceColorEffectsRenderer.prototype.alphaBlend=function(e,t){var r=(e|=0)>>10&31,s=e>>5&31,i=31&e,o=(t|=0)>>10&31,n=t>>5&31,f=31&t;return r=0|Math.imul(0|r,0|this.alphaBlendAmountTarget1),s=0|Math.imul(0|s,0|this.alphaBlendAmountTarget1),i=0|Math.imul(0|i,0|this.alphaBlendAmountTarget1),o=0|Math.imul(0|o,0|this.alphaBlendAmountTarget2),n=0|Math.imul(0|n,0|this.alphaBlendAmountTarget2),f=0|Math.imul(0|f,0|this.alphaBlendAmountTarget2),(0|Math.min((0|r)+(0|o)>>4,31))<<10|(0|Math.min((0|s)+(0|n)>>4,31))<<5|(0|Math.min((0|i)+(0|f)>>4,31))},GameBoyAdvanceColorEffectsRenderer.prototype.brightnessIncrease=function(e){var t=(e|=0)>>10&31,r=e>>5&31,s=31&e;return(t=(0|t)+(Math.imul(31-(0|t)|0,0|this.brightnessEffectAmount)>>4)|0)<<10|(r=(0|r)+(Math.imul(31-(0|r)|0,0|this.brightnessEffectAmount)>>4)|0)<<5|(s=(0|s)+(Math.imul(31-(0|s)|0,0|this.brightnessEffectAmount)>>4)|0)},GameBoyAdvanceColorEffectsRenderer.prototype.brightnessDecrease=function(e){var t=(e|=0)>>10&31,r=e>>5&31,s=31&e,i=16-(0|this.brightnessEffectAmount)|0;return(t=Math.imul(0|t,0|i)>>4)<<10|(r=Math.imul(0|r,0|i)>>4)<<5|(s=Math.imul(0|s,0|i)>>4)}):(GameBoyAdvanceColorEffectsRenderer.prototype.alphaBlend=function(e,t){var r=(e|=0)>>10&31,s=e>>5&31,i=31&e,o=(t|=0)>>10&31,n=t>>5&31,f=31&t;return r*=this.alphaBlendAmountTarget1,s*=this.alphaBlendAmountTarget1,i*=this.alphaBlendAmountTarget1,o*=this.alphaBlendAmountTarget2,n*=this.alphaBlendAmountTarget2,f*=this.alphaBlendAmountTarget2,Math.min(r+o>>4,31)<<10|Math.min(s+n>>4,31)<<5|Math.min(i+f>>4,31)},GameBoyAdvanceColorEffectsRenderer.prototype.brightnessIncrease=function(e){var t=(e|=0)>>10&31,r=e>>5&31,s=31&e;return(t+=(31-t)*this.brightnessEffectAmount>>4)<<10|(r+=(31-r)*this.brightnessEffectAmount>>4)<<5|(s+=(31-s)*this.brightnessEffectAmount>>4)},GameBoyAdvanceColorEffectsRenderer.prototype.brightnessDecrease=function(e){var t=(e|=0)>>10&31,r=e>>5&31,s=31&e,i=16-this.brightnessEffectAmount;return(t=t*i>>4)<<10|(r=r*i>>4)<<5|(s=s*i>>4)}),GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDALPHA8_0=function(e){var t=31&(e|=0);this.alphaBlendAmountTarget1=0|Math.min(0|t,16)},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDALPHA8_1=function(e){var t=31&(e|=0);this.alphaBlendAmountTarget2=0|Math.min(0|t,16)},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDALPHA16=function(e){var t=31&(e|=0);this.alphaBlendAmountTarget1=0|Math.min(0|t,16);var r=e>>8&31;this.alphaBlendAmountTarget2=0|Math.min(0|r,16)},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDCNT32=function(e){e|=0,this.effectsTarget1=(63&e)<<16,this.colorEffectsType=e>>6&3,this.effectsTarget2=(16128&e)<<8;var t=e>>16&31;this.alphaBlendAmountTarget1=0|Math.min(0|t,16);var r=e>>24&31;this.alphaBlendAmountTarget2=0|Math.min(0|r,16)},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDY8=function(e){e|=0,this.brightnessEffectAmount=0|Math.min(31&e,16)}),GameBoyAdvanceColorEffectsRenderer.prototype.processPixelNormal=function(e,t){if(e|=0,0!=((0|(t|=0))&(0|this.effectsTarget1)))switch(0|this.colorEffectsType){case 1:if(0!=((0|e)&(0|this.effectsTarget2))&&(0|t)!=(0|e))return 0|this.alphaBlend(0|t,0|e);break;case 2:return 0|this.brightnessIncrease(0|t);case 3:return 0|this.brightnessDecrease(0|t)}return 0|t},GameBoyAdvanceColorEffectsRenderer.prototype.processPixelSprite=function(e,t){if(t|=0,0!=((0|(e|=0))&(0|this.effectsTarget2)))return 0|this.alphaBlend(0|t,0|e);if(0!=((0|t)&(0|this.effectsTarget1)))switch(0|this.colorEffectsType){case 2:return 0|this.brightnessIncrease(0|t);case 3:return 0|this.brightnessDecrease(0|t)}return 0|t},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDCNT8_0=function(e){e|=0,this.effectsTarget1=(63&e)<<16,this.colorEffectsType=e>>6},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDCNT8_1=function(e){e|=0,this.effectsTarget2=(63&e)<<16},GameBoyAdvanceColorEffectsRenderer.prototype.writeBLDCNT16=function(e){e|=0,this.effectsTarget1=(63&e)<<16,this.colorEffectsType=e>>6&3,this.effectsTarget2=(16128&e)<<8};
//# sourceMappingURL=build-index.943674f0.js.map
