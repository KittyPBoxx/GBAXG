"use strict";function GameBoyAdvanceDMA3(t){this.IOCore=t}GameBoyAdvanceDMA3.prototype.DMA_ENABLE_TYPE=[1,2,4,32],GameBoyAdvanceDMA3.prototype.initialize=function(){this.enabled=0,this.pending=0,this.source=0,this.sourceShadow=0,this.destination=0,this.destinationShadow=0,this.wordCount=0,this.wordCountShadow=0,this.irqFlagging=0,this.dmaType=0,this.is32Bit=0,this.repeat=0,this.sourceControl=0,this.destinationControl=0,this.gamePakDMA=0,this.displaySyncEnableDelay=0,this.DMACore=this.IOCore.dma,this.memory=this.IOCore.memory,this.gfxState=this.IOCore.gfxState,this.irq=this.IOCore.irq},GameBoyAdvanceDMA3.prototype.validateDMASource=function(t){(0|(t|=0))>=33554432&&(this.source=0|t)},GameBoyAdvanceDMA3.prototype.writeDMASource8_0=function(t){t|=0;var e=268435200&this.source;e|=t&=255,this.validateDMASource(0|e)},GameBoyAdvanceDMA3.prototype.writeDMASource8_1=function(t){t|=0;var e=268370175&this.source;e|=(t&=255)<<8,this.validateDMASource(0|e)},GameBoyAdvanceDMA3.prototype.writeDMASource8_2=function(t){t|=0;var e=251723775&this.source;e|=(t&=255)<<16,this.validateDMASource(0|e)},GameBoyAdvanceDMA3.prototype.writeDMASource8_3=function(t){t|=0;var e=16777215&this.source;e|=(t&=15)<<24,this.validateDMASource(0|e)},GameBoyAdvanceDMA3.prototype.writeDMASource16_0=function(t){t|=0;var e=268369920&this.source;e|=t&=65535,this.validateDMASource(0|e)},GameBoyAdvanceDMA3.prototype.writeDMASource16_1=function(t){t|=0;var e=65535&this.source;e|=(t&=4095)<<16,this.validateDMASource(0|e)},GameBoyAdvanceDMA3.prototype.writeDMASource32=function(t){var e=268435455&(t|=0);this.validateDMASource(0|e)},GameBoyAdvanceDMA3.prototype.writeDMADestination8_0=function(t){t|=0,this.destination=268435200&this.destination,t&=255,this.destination=this.destination|t},GameBoyAdvanceDMA3.prototype.writeDMADestination8_1=function(t){t|=0,this.destination=268370175&this.destination,t&=255,this.destination=this.destination|t<<8},GameBoyAdvanceDMA3.prototype.writeDMADestination8_2=function(t){t|=0,this.destination=251723775&this.destination,t&=255,this.destination=this.destination|t<<16},GameBoyAdvanceDMA3.prototype.writeDMADestination8_3=function(t){t|=0,this.destination=16777215&this.destination,t&=15,this.destination=this.destination|t<<24},GameBoyAdvanceDMA3.prototype.writeDMADestination16_0=function(t){t|=0,this.destination=268369920&this.destination,t&=65535,this.destination=this.destination|t},GameBoyAdvanceDMA3.prototype.writeDMADestination16_1=function(t){t|=0,this.destination=65535&this.destination,t&=4095,this.destination=this.destination|t<<16},GameBoyAdvanceDMA3.prototype.writeDMADestination32=function(t){t|=0,this.destination=268435455&t},GameBoyAdvanceDMA3.prototype.writeDMAWordCount8_0=function(t){t|=0,this.wordCount=65280&this.wordCount,t&=255,this.wordCount=this.wordCount|t},GameBoyAdvanceDMA3.prototype.writeDMAWordCount8_1=function(t){t|=0,this.wordCount=255&this.wordCount,t&=255,this.wordCount=this.wordCount|t<<8},GameBoyAdvanceDMA3.prototype.writeDMAWordCount16=function(t){t|=0,this.wordCount=65535&t},GameBoyAdvanceDMA3.prototype.writeDMAControl8_0=function(t){t|=0,this.destinationControl=t>>5&3,this.sourceControl=2&this.sourceControl,this.sourceControl=this.sourceControl|t>>7&1},GameBoyAdvanceDMA3.prototype.writeDMAControl8_1=function(t){t|=0,this.IOCore.updateCoreClocking(),this.sourceControl=1&this.sourceControl|(1&t)<<1,this.repeat=2&t,this.is32Bit=4&t,this.gamePakDMA=8&t,this.dmaType=t>>4&3,this.irqFlagging=64&t,this.enableDMAChannel(128&t),this.IOCore.updateCoreEventTime()},GameBoyAdvanceDMA3.prototype.writeDMAControl16=function(t){t|=0,this.IOCore.updateCoreClocking(),this.destinationControl=t>>5&3,this.sourceControl=t>>7&3,this.repeat=t>>8&2,this.is32Bit=t>>8&4,this.gamePakDMA=t>>8&8,this.dmaType=t>>12&3,this.irqFlagging=t>>8&64,this.enableDMAChannel(32768&t),this.IOCore.updateCoreEventTime()},GameBoyAdvanceDMA3.prototype.writeDMAControl32=function(t){t|=0,this.writeDMAWordCount16(0|t),this.writeDMAControl16(t>>16)},GameBoyAdvanceDMA3.prototype.readDMAControl8_0=function(){var t=this.destinationControl<<5;return 0|(t|=(1&this.sourceControl)<<7)},GameBoyAdvanceDMA3.prototype.readDMAControl8_1=function(){var t=this.sourceControl>>1;return t|=this.repeat,t|=this.is32Bit,t|=this.gamePakDMA,t|=this.dmaType<<4,t|=this.irqFlagging,0!=(0|this.enabled)&&(t|=128),0|t},GameBoyAdvanceDMA3.prototype.readDMAControl16=function(){var t=this.destinationControl<<5;return t|=this.sourceControl<<7,t|=this.repeat<<8,t|=this.is32Bit<<8,t|=this.gamePakDMA<<8,t|=this.dmaType<<12,t|=this.irqFlagging<<8,0!=(0|this.enabled)&&(t|=32768),0|t},GameBoyAdvanceDMA3.prototype.getMatchStatus=function(){return this.enabled&this.pending},GameBoyAdvanceDMA3.prototype.gfxDisplaySyncRequest=function(){this.requestDMA(32^this.displaySyncEnableDelay)},GameBoyAdvanceDMA3.prototype.gfxDisplaySyncEnableCheck=function(){32==(0|this.enabled)&&(32==(0|this.displaySyncEnableDelay)?this.displaySyncEnableDelay=0:(this.enabled=0,this.DMACore.update()))},GameBoyAdvanceDMA3.prototype.requestDMA=function(t){t|=0,0!=(this.enabled&t)&&(this.pending=0|t,this.DMACore.update())},GameBoyAdvanceDMA3.prototype.enableDMAChannel=function(t){if(0!=(0|(t|=0))){if(0==(0|this.enabled)){switch(0|this.dmaType){case 0:this.pending=1;break;case 3:this.displaySyncEnableDelay=32}this.wordCountShadow=0|this.wordCount,this.sourceShadow=0|this.source,this.destinationShadow=0|this.destination}this.enabled=0|this.DMA_ENABLE_TYPE[0|this.dmaType],this.pending=this.pending&this.enabled}else this.enabled=0;this.DMACore.update()},GameBoyAdvanceDMA3.prototype.handleDMACopy=function(){var t=0|this.sourceShadow,e=0|this.destinationShadow;4==(0|this.is32Bit)?this.copy32(0|t,0|e):this.copy16(0|t,0|e)},GameBoyAdvanceDMA3.prototype.copy16=function(t,e){t|=0,e|=0;var i=0|this.memory.memoryReadDMAFull16(0|t);this.memory.memoryWriteDMAFull16(0|e,0|i),this.decrementWordCount(0|t,0|e,2),this.DMACore.updateFetch(i|i<<16)},GameBoyAdvanceDMA3.prototype.copy32=function(t,e){t|=0,e|=0;var i=0|this.memory.memoryReadDMAFull32(0|t);this.memory.memoryWriteDMAFull32(0|e,0|i),this.decrementWordCount(0|t,0|e,4),this.DMACore.updateFetch(0|i)},GameBoyAdvanceDMA3.prototype.decrementWordCount=function(t,e,i){t|=0,e|=0,i|=0;var o=(0|this.wordCountShadow)-1&65535;0==(0|o)?o=0|this.finalizeDMA(0|t,0|e,0|i):this.incrementDMAAddresses(0|t,0|e,0|i),this.wordCountShadow=0|o},GameBoyAdvanceDMA3.prototype.finalizeDMA=function(t,e,i){t|=0,e|=0,i|=0;var o=0;return this.pending=0,0==(0|this.repeat)||1==(0|this.enabled)?this.enabled=0:o=0|this.wordCount,this.DMACore.update(),this.checkIRQTrigger(),this.finalDMAAddresses(0|t,0|e,0|i),0|o},GameBoyAdvanceDMA3.prototype.checkIRQTrigger=function(){0!=(0|this.irqFlagging)&&this.irq.requestIRQ(2048)},GameBoyAdvanceDMA3.prototype.finalDMAAddresses=function(t,e,i){switch(t|=0,e|=0,i|=0,0|this.sourceControl){case 0:case 3:this.sourceShadow=(0|t)+(0|i)|0;break;case 1:this.sourceShadow=(0|t)-(0|i)|0}switch(0|this.destinationControl){case 0:this.destinationShadow=(0|e)+(0|i)|0;break;case 1:this.destinationShadow=(0|e)-(0|i)|0;break;case 3:this.destinationShadow=0|this.destination}},GameBoyAdvanceDMA3.prototype.incrementDMAAddresses=function(t,e,i){switch(t|=0,e|=0,i|=0,0|this.sourceControl){case 0:case 3:this.sourceShadow=(0|t)+(0|i)|0;break;case 1:this.sourceShadow=(0|t)-(0|i)|0}switch(0|this.destinationControl){case 0:case 3:this.destinationShadow=(0|e)+(0|i)|0;break;case 1:this.destinationShadow=(0|e)-(0|i)|0}},GameBoyAdvanceDMA3.prototype.nextEventTime=function(){var t=2147483647;switch(0|this.enabled){case 2:t=0|this.gfxState.nextVBlankEventTime();break;case 4:t=0|this.gfxState.nextHBlankDMAEventTime();break;case 32:t=0|this.gfxState.nextDisplaySyncEventTime(0|this.displaySyncEnableDelay)}return 0|t};
//# sourceMappingURL=build-index.77cc62ca.js.map
